import{j as f,k as i,l as e,p as Be,q as O,r as b,d as F,u as ae,s as U,F as L,v as B,x as G,y as ye,z as ke,A as j,B as $,C as X,D as Me,E as P,T as ze,G as C,H as M,I as le,J as De,K as Ae,L as J,M as R,N as D,R as Z,O as we,P as q,a as Q,Q as je,S as Je,U as Ge,w as ve,n as We,V as ee,W as Ke,X as Ye,Y as Xe,Z as Qe,_ as Ze}from"./vendor-vue-DTvoq0oe.js";import{e as et,f as tt,g as st}from"./vendor-BN7K03Tt.js";import{a as nt}from"./vendor-axios-Dq7h7Pqt.js";import{l as at}from"./vendor-socket-jvIWHPPT.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const p of l)if(p.type==="childList")for(const u of p.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function h(l){const p={};return l.integrity&&(p.integrity=l.integrity),l.referrerPolicy&&(p.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?p.credentials="include":l.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function s(l){if(l.ep)return;l.ep=!0;const p=h(l);fetch(l.href,p)}})();const ot={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function lt(x,m){return i(),f("svg",ot,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const xe={render:lt},rt={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function it(x,m){return i(),f("svg",rt,m[0]||(m[0]=[Be('<g fill="currentColor" clip-path="url(#a)"><path fill-rule="evenodd" d="M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87" clip-rule="evenodd"></path><path d="M9 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8"></path><path fill-rule="evenodd" d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24a5.98 5.98 0 0 1 0 7.52c.42.14.86.24 1.33.24M9 13c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4" clip-rule="evenodd"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h24v24H0z"></path></clipPath></defs>',2)]))}const Ce={render:it},ut={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function dt(x,m){return i(),f("svg",ut,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M20 6h-1v8c0 .55-.45 1-1 1H6v1c0 1.1.9 2 2 2h10l4 4V8c0-1.1-.9-2-2-2m-3 5V4c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v13l4-4h9c1.1 0 2-.9 2-2"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const me={render:dt},ct={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function pt(x,m){return i(),f("svg",ct,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-6 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1m3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const mt={render:pt},vt={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function ft(x,m){return i(),f("svg",vt,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M5 13.18v2.81c0 .73.4 1.41 1.04 1.76l5 2.73c.6.33 1.32.33 1.92 0l5-2.73c.64-.35 1.04-1.03 1.04-1.76v-2.81l-6.04 3.3c-.6.33-1.32.33-1.92 0zm6.04-9.66-8.43 4.6c-.69.38-.69 1.38 0 1.76l8.43 4.6c.6.33 1.32.33 1.92 0L21 10.09V16c0 .55.45 1 1 1s1-.45 1-1V9.59c0-.37-.2-.7-.52-.88l-9.52-5.19a2.04 2.04 0 0 0-1.92 0"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const gt={render:ft},ht={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function _t(x,m){return i(),f("svg",ht,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M4 14h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M4 9h2c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m5 5h10c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h10c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M8 6v2c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const yt={render:_t},ce=et("user",{state:()=>({currentUser:JSON.parse(localStorage.getItem("currentUser")||"null")}),actions:{setUser(x){this.currentUser=x,localStorage.setItem("currentUser",JSON.stringify(x))},logout(){this.currentUser=null,localStorage.removeItem("currentUser")}},getters:{isAuthenticated:x=>!!x.currentUser,userRole:x=>{var m;return((m=x.currentUser)==null?void 0:m.role)??""}}}),T=nt.create({baseURL:"http://localhost:5050/api",withCredentials:!0}),bt={class:"sidebar container"},$t={class:"links-container"},kt={class:"icon"},wt={key:0,class:"error"},It=O({__name:"Sidebar",setup(x){const m=[{id:1,content:"Главная",icon:xe,path:"/"},{id:6,content:"Тимлиды",icon:Ce,path:"/teamleads"},{id:5,content:"Должности",icon:mt,path:"/positions"},{id:3,content:"Чат",icon:me,path:"/chats"},{id:2,content:"Стажеры",icon:Ce,path:"/interns"},{id:4,content:"Управление Онбордингами",icon:yt,path:"/control"}],h=[{id:1,content:"Главная",icon:xe,path:"/"},{id:2,content:"Стажеры",icon:Ce,path:"/interns"},{id:3,content:"Чат",icon:me,path:"/chats"},{id:4,content:"Управление Онбордингами",icon:me,path:"/control"}],s=[{id:1,content:"Главная",icon:xe,path:"/"},{id:2,content:"Онбординг",icon:gt,path:"/stages"},{id:3,content:"Чат",icon:me,path:"/chats"}],l=ae(),p=X(),u=ce(),n=u.currentUser,c=b(null),t=F(()=>{switch(n==null?void 0:n.role){case"HR":return m;case"TEAMLEAD":return h;case"INTERN":return s}}),y=F(()=>l.path),a=F(()=>{const r=y.value.indexOf("/",1);return r===-1?y.value:y.value.slice(0,r)}),o=r=>(r.indexOf("/",1)===-1?r:r.slice(0,r.indexOf("/",1)))===a.value;async function g(){var r;c.value=null;try{const _=await T.post("/auth/logout");(_.status===200||_.status===201)&&(u.logout(),p.push("/login"))}catch(_){console.error(_),c.value=((r=_.response)==null?void 0:r.data.message)??"Ошибка при выходе из аккаунты"}}return(r,_)=>{const d=ye("RouterLink");return i(),f("div",bt,[_[0]||(_[0]=e("div",{class:"logo"}," OnboardMe ",-1)),e("div",$t,[(i(!0),f(L,null,B(t.value,v=>(i(),G(d,{to:v.path,key:v.id,class:ke(["link",{active:o(v.path)}])},{default:j(()=>[e("div",kt,[(i(),G(Me(v.icon),{class:"svg-icon"}))]),e("p",null,$(v.content),1)]),_:2},1032,["to","class"]))),128))]),e("span",{class:"logout-link",onClick:g},"Выйти"),c.value?(i(),f("span",wt,$(c.value),1)):U("",!0)])}}}),N=(x,m)=>{const h=x.__vccOpts||x;for(const[s,l]of m)h[s]=l;return h},xt=N(It,[["__scopeId","data-v-ff29699d"]]),Ct={class:"main"},Tt=O({__name:"App",setup(x){const m=ae(),h=F(()=>m.path==="/login"||m.path==="/register");return(s,l)=>{const p=ye("RouterView");return i(),f("div",Ct,[h.value?U("",!0):(i(),G(xt,{key:0})),P(p,{class:ke({container:!h.value})},null,8,["class"]),P(p,{name:"modal"},{default:j(({Component:u})=>[P(ze,null,{default:j(()=>[u?(i(),G(Me(u),{key:0})):U("",!0)]),_:2},1024)]),_:1})])}}}),St=N(Tt,[["__scopeId","data-v-5e1f8dbb"]]),Pt={class:"dashboardPage"},Rt={class:"counters dark-blue-container"},Ut={class:"positions dark-blue-container"},Ht=O({__name:"dashboardPage",setup(x){const m=b([72]),h=b({chart:{toolbar:{show:!1},fontFamily:"Jost",type:"radialBar",offsetY:-20,sparkline:{enabled:!0}},plotOptions:{radialBar:{startAngle:-90,endAngle:90,track:{background:"#E0E0E0",strokeWidth:"100%",margin:5},hollow:{margin:0,size:"60%"},dataLabels:{name:{show:!1},value:{color:"white",offsetY:-10,fontSize:"24px",fontWeight:700,formatter:s=>`${s}%`}}}},fill:{colors:["#7B61FF"]},stroke:{lineCap:"round"},labels:["Progress"]});return(s,l)=>(i(),f("div",Pt,[l[3]||(l[3]=e("div",{class:"dark-blue-contaoner mes"},"В РАЗРАБОТКЕ",-1)),e("div",Rt,[l[0]||(l[0]=e("div",{class:"stats"},[e("h4",null,"Онбординг"),e("p",null,[C("Всего сотрудников: "),e("strong",null,"34")]),e("p",null,[C("Завершили онбординг: "),e("strong",null,"26")])],-1)),P(M(le),{type:"radialBar",width:"100%",height:"300px",options:h.value,series:m.value},null,8,["options","series"])]),l[4]||(l[4]=e("div",{class:"progress dark-blue-container"},[e("h4",null,"Проблемные зоны")],-1)),l[5]||(l[5]=e("div",{class:"activity dark-blue-container"},[e("h4",null,"Последняя активность")],-1)),e("div",Ut,[l[1]||(l[1]=e("h4",null,"Должности",-1)),l[2]||(l[2]=e("p",null,[C("Всего: "),e("strong",null,"25")],-1)),P(M(le),{type:"radialBar",width:"100%",height:"300px",options:h.value,series:m.value},null,8,["options","series"])]),l[6]||(l[6]=e("div",{class:"new-users dark-blue-container"},[e("div",{class:"new-user-item dark-blue-container"},"леха")],-1)),l[7]||(l[7]=e("div",{class:"users-graph dark-blue-container"},[e("h4",null,"Последняя активность")],-1))]))}}),Et=N(Ht,[["__scopeId","data-v-d2930a33"]]),Mt={class:"border-shadow"},Dt=O({__name:"TextCard",props:{text:{type:String,default:"Не назначена"},color:{type:String,default:"#c4c4c4"}},setup(x){Ae(s=>({bed3ac98:x.color,"2bd5d51d":h.value[0],"2bd5d53c":h.value[1],"2bd5d55b":h.value[2]}));const m=x,h=F(()=>{const s=(m.color||"#c4c4c4").replace("#",""),l=parseInt(s.substring(0,2),16),p=parseInt(s.substring(2,4),16),u=parseInt(s.substring(4,6),16);return[l,p,u]});return(s,l)=>(i(),f("div",Mt,[e("span",{style:De({color:x.color})},$(x.text),5)]))}}),W=N(Dt,[["__scopeId","data-v-d9667e0f"]]),At={},qt={class:"loader"};function Vt(x,m){return i(),f("span",qt)}const pe=N(At,[["render",Vt],["__scopeId","data-v-7dfaf4c9"]]),Lt={class:"chatsPage"},Nt={class:"chats dark-blue-container"},Ft={key:1,class:"no-chats-message"},Ot=["src"],Bt={class:"content"},zt={class:"profile"},jt={class:"name"},Jt={key:0,class:"last-msg"},Gt=["onClick"],Wt=["src"],Kt={class:"content"},Yt={class:"profile"},Xt={class:"name"},Qt=O({__name:"chatsPage",setup(x){const m=X(),h=b(!0),s=b(null),l=ce(),p=b(""),u=b([]),n=b(!1),c=F(()=>{var d;if(!p.value.trim())return s.value?[...new Map(s.value.map(v=>[v.id,v])).values()]:[];const _=p.value.toLowerCase();return((d=s.value)==null?void 0:d.filter(v=>{var E;const k=v.participants.map(te=>te.name.toLowerCase()).join(" "),w=((E=v.groupName)==null?void 0:E.toLowerCase())||"";return k.includes(_)||w.includes(_)}))||[]}),t=F(()=>u.value.filter(_=>{var d;return!((d=s.value)!=null&&d.some(v=>v.participants.some(k=>k.id===_.id)))}).filter((_,d,v)=>d===v.findIndex(k=>k.id===_.id)));function y(_,d){let v;return function(...k){clearTimeout(v),v=setTimeout(()=>_.apply(this,k),d)}}async function a(){if(!p.value.trim()){u.value=[];return}n.value=!0;try{const{data:_}=await T.get("/chats/search-users",{params:{query:p.value}});u.value=_.users}catch(_){console.error(_)}finally{n.value=!1}}const o=y(a,300);async function g(_){var d,v;try{const w=(await T.post("/chats",{participants:[{userId:(d=l.currentUser)==null?void 0:d.id,role:(v=l.currentUser)==null?void 0:v.role},{userId:_.id,role:_.role}]})).data.chat.id;await r(),m.push(`/chats/${w}`)}catch(k){console.error("Ошибка при создании чата:",k)}}async function r(){var _,d;try{const v=(_=l.currentUser)==null?void 0:_.id,k=await T.get(`/chats/for-user/${v}`);s.value=k.data.chats||[],h.value=!1}catch(v){console.error(v),((d=v.response)==null?void 0:d.status)===404&&(s.value=[]),h.value=!1}}return J(async()=>{await r()}),(_,d)=>(i(),f("div",Lt,[e("div",Nt,[d[2]||(d[2]=e("h2",null,"Чаты",-1)),R(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=v=>p.value=v),onInput:d[1]||(d[1]=(...v)=>M(o)&&M(o)(...v)),placeholder:"Поиск пользователей",class:"search-input"},null,544),[[D,p.value]]),h.value||n.value?(i(),G(pe,{key:0})):!h.value&&(!s.value||s.value.length===0)&&!p.value.trim()?(i(),f("div",Ft," У вас пока нет чатов. Начните общение, найдя пользователя через поиск. ")):(i(),f(L,{key:2},[(i(!0),f(L,null,B(c.value,v=>(i(),G(M(Z),{key:v.id,to:`/chats/${v.id}`,class:"chat"},{default:j(()=>{var k,w,E,te;return[e("img",{src:((k=v.participants[0])==null?void 0:k.avatar)||"/img/noimage.jpg"},null,8,Ot),e("div",Bt,[e("div",zt,[e("div",jt,$(v.groupName||((w=v.participants[0])==null?void 0:w.name)||"Без имени"),1),(E=v.participants[0])!=null&&E.position?(i(),G(W,{key:0,text:v.participants[0].position,color:"#0075FF"},null,8,["text"])):U("",!0),P(W,{text:(te=v.participants[0])==null?void 0:te.role,color:"#adff2f"},null,8,["text"])]),v.lastMessage?(i(),f("div",Jt,$(v.lastMessage.length>150?v.lastMessage.substring(0,150)+"...":v.lastMessage),1)):U("",!0)])]}),_:2},1032,["to"]))),128)),(i(!0),f(L,null,B(t.value,v=>(i(),f("div",{key:v.id,class:"chat",onClick:k=>g(v)},[e("img",{src:v.avatar||"/img/noimage.jpg"},null,8,Wt),e("div",Kt,[e("div",Yt,[e("div",Xt,$(v.name),1),v.position?(i(),G(W,{key:0,text:v.position,color:"#0075FF"},null,8,["text"])):U("",!0),P(W,{text:v.role,color:"#adff2f"},null,8,["text"])])])],8,Gt))),128))],64))])]))}}),Zt=N(Qt,[["__scopeId","data-v-442306b8"]]),es={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function ts(x,m){return i(),f("svg",es,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1q-.15.15-.15.36M20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const be={render:ts},z=tt(),ss={class:"internsPage dark-blue-container"},ns={class:"buttons"},as={key:0,class:"error"},os={class:"interns-table"},ls=["onClick"],rs={class:"profile"},is=["src","alt"],us={class:"names"},ds={class:"textcard"},cs={class:"textcard"},ps={class:""},ms={class:"interactions"},vs={class:"icon"},fs={class:"icon"},gs=O({__name:"internsPage",setup(x){const m=b(null),h=b(null),s=b(!0);async function l(){try{const u=await T.get("/users/interns");m.value=u.data.interns}catch(u){console.error(u)}finally{s.value=!1}}J(async()=>{await l(),z.on("reloadInterns",l)}),we(()=>{z.off("reloadInterns",l)});const p=u=>{Ie.push(`/interns/${u}`)};return(u,n)=>(i(),f("div",ss,[n[9]||(n[9]=e("h2",null,"Стажеры/Новые разработчики",-1)),e("div",ns,[P(M(Z),{to:"/interns/add"},{default:j(()=>n[2]||(n[2]=[e("button",{class:"add"},"Добавить стажера",-1)])),_:1,__:[2]}),n[3]||(n[3]=e("button",{class:"statistics"},"Общая статистика",-1))]),h.value?(i(),f("span",as,$(h.value),1)):U("",!0),e("table",os,[n[8]||(n[8]=e("thead",null,[e("tr",null,[e("th",{class:""},"Сотрудник"),e("th",{class:""},"Должность"),e("th",{class:""},"Роль"),e("th",{class:""},"Статус"),e("th",{class:""},"Прогресс"),e("th",{class:""},"Текущий этап"),e("th",{class:""},"Наставник"),e("th",{class:""},"Дата начала"),e("th",{class:""},"Изменить")])],-1)),e("tbody",null,[s.value?(i(),G(pe,{key:0})):(i(!0),f(L,{key:1},B(m.value,c=>{var t,y,a;return i(),f("tr",{key:c.id,class:"intern",onClick:o=>p(c.id)},[e("td",rs,[e("img",{src:c.avatar||"/img/noimage.jpg",alt:c.name},null,8,is),e("div",us,[e("span",null,$(c.name),1),e("span",null,$(c.login),1)])]),e("td",ds,[P(W,{color:(t=c.position)==null?void 0:t.color,text:(y=c.position)==null?void 0:y.name},null,8,["color","text"])]),e("td",cs,[P(W,{color:"#adff2f",text:"Стажер"})]),n[4]||(n[4]=e("td",{class:""},null,-1)),n[5]||(n[5]=e("td",{class:"progress"},null,-1)),n[6]||(n[6]=e("td",{class:""},null,-1)),e("td",ps,$((a=c.teamlead)==null?void 0:a.name),1),n[7]||(n[7]=e("td",{class:""},null,-1)),e("td",ms,[P(M(Z),{onClick:n[0]||(n[0]=q(()=>{},["stop"])),to:"/chats/userId"},{default:j(()=>[e("button",vs,[P(M(me))])]),_:1}),P(M(Z),{onClick:n[1]||(n[1]=q(()=>{},["stop"])),to:`/interns/update/${c.id}`},{default:j(()=>[e("button",fs,[P(M(be))])]),_:2},1032,["to"])])],8,ls)}),128))])])]))}}),Te=N(gs,[["__scopeId","data-v-40d2611c"]]),hs={class:"internProfilePage"},_s={key:0,class:"edit-profile dark-blue-container"},ys={class:"profile"},bs=["src","alt"],$s={class:"names"},ks={class:"name"},ws={class:"login"},Is={class:"edit"},xs={class:"statistics-grid"},Cs={class:"chart-container activity dark-blue-container"},Ts={class:"chart-container stages dark-blue-container"},Ss={class:"chart-container tasks dark-blue-container"},Ps={class:"time dark-blue-container"},Rs={class:"chart-container avg-time dark-blue-container"},Us=O({__name:"internProfilePage",setup(x){const m=[{name:"Алексей",avatar:"https://example.com/alex.png",value:3},{name:"Мария",avatar:"https://example.com/maria.png",value:2},{name:"Иван",avatar:"https://example.com/ivan.png",value:1}],h=ae(),s=b(null),l=b(null);async function p(){var v;const d=h.params.id;try{if(typeof d!="string")throw new Error("Недопустимый тип ID!");const k=await T.get(`/users/interns/${d}`);if(l.value=k.data.intern,!l.value)throw new Error("Не удалось получить стажера")}catch(k){console.error(k),s.value=((v=k.response)==null?void 0:v.data.message)??"Не удалось получить стажера"}}J(()=>{p()});const u=b({chart:{toolbar:{show:!1},fontFamily:"Jost",type:"bar"},tooltip:{theme:"dark",style:{fontSize:"1em",fontFamily:"Jost, Inter, sans-serif"}},xaxis:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],labels:{style:{colors:"#fff"}}},yaxis:{labels:{style:{colors:"#fff"}}},colors:["#7B61FF"]}),n=b([{name:"Активность",data:[4,5,3,2,4,1,5]}]),c=b({chart:{toolbar:{show:!1},fontFamily:"Jost",type:"bar"},tooltip:{theme:"dark",style:{fontSize:"1em",fontFamily:"Jost, Inter, sans-serif"}},xaxis:{show:!1},yaxis:{categories:["Введение","Настройка окружения","Этап 3","Этап 4","Этап 5"],labels:{style:{colors:"#fff"}}},colors:["#7B61FF"],plotOptions:{bar:{horizontal:!0}}}),t=b([{name:"Прогресс",data:[3.3,12.7,15.2,25.3,33.5]}]),y=b({chart:{toolbar:{show:!1},fontFamily:"Jost",type:"line"},tooltip:{theme:"dark",style:{fontSize:"1em",fontFamily:"Jost, Inter, sans-serif"}},xaxis:{categories:[1,2,3,4,5,6,7,8,9],labels:{style:{colors:"#fff"}}},yaxis:{labels:{style:{colors:"#fff"}}},stroke:{curve:"smooth"},colors:["#7B61FF"]}),a=b([{name:"Время",data:[2,3,4,2,3,4,5,4,3]}]),o=b({chart:{type:"bar",toolbar:{show:!1},fontFamily:"Jost"},xaxis:{categories:m.map((d,v)=>v),labels:{useHTML:!0,formatter:(d,v)=>{const k=m[v];return k?`<img src="${k.avatar}" title="${k.name}" style="width:30px;height:30px;border-radius:50%;" />`:""},style:{colors:"#fff"}}},tooltip:{x:{formatter:(d,{dataPointIndex:v})=>{const k=m[v];return k?k.name:""}}}}),g=b([{name:"Среднее время",data:m.map(d=>d.value)}]),r=b([72]),_=b({chart:{toolbar:{show:!1},fontFamily:"Jost",type:"radialBar",offsetY:-20,sparkline:{enabled:!0}},plotOptions:{radialBar:{startAngle:-90,endAngle:90,track:{background:"#E0E0E0",strokeWidth:"100%",margin:5},hollow:{margin:0,size:"60%"},dataLabels:{name:{show:!1},value:{color:"white",offsetY:-10,fontSize:"24px",fontWeight:700,formatter:d=>`${d}%`}}}},fill:{colors:["#7B61FF"]},stroke:{lineCap:"round"},labels:["Progress"]});return(d,v)=>{var k,w;return i(),f("div",hs,[l.value?(i(),f("div",_s,[e("div",ys,[e("img",{src:l.value.avatar||"/img/noimage.jpg",alt:l.value.name},null,8,bs),e("div",$s,[e("div",ks,[C($(l.value.name)+" ",1),P(W,{color:(k=l.value.position)==null?void 0:k.color,text:(w=l.value.position)==null?void 0:w.name},null,8,["color","text"]),P(W,{color:"#adff2f",text:l.value.role},null,8,["text"])]),e("div",ws,$(l.value.login),1)])]),e("button",Is,[P(M(be))])])):U("",!0),e("div",xs,[e("div",Cs,[v[0]||(v[0]=e("h4",null,"Активность",-1)),P(M(le),{type:"bar",width:"100%",height:"300px",options:u.value,series:n.value},null,8,["options","series"])]),e("div",Ts,[v[1]||(v[1]=e("h4",null,"Этапы",-1)),P(M(le),{type:"bar",width:"100%",height:"300px",options:c.value,series:t.value},null,8,["options","series"])]),e("div",Ss,[v[2]||(v[2]=e("div",{class:"stats"},[e("p",null,[C("Всего задач: "),e("strong",null,"34")]),e("p",null,[C("Выполнено: "),e("strong",null,"26")])],-1)),P(M(le),{type:"radialBar",width:"100%",height:"300px",options:_.value,series:r.value},null,8,["options","series"])]),e("div",Ps,[v[3]||(v[3]=e("h4",null,"Время выполнения задач",-1)),P(M(le),{type:"line",width:"100%",height:"300px",options:y.value,series:a.value},null,8,["options","series"])]),e("div",Rs,[v[4]||(v[4]=e("h4",null,"Среднее время выполнения задач",-1)),P(M(le),{type:"bar",width:"100%",height:"300px",options:o.value,series:g.value},null,8,["options","series"])])])])}}}),Hs=N(Us,[["__scopeId","data-v-d4c56333"]]),Es={class:"loginPage"},Ms={class:"right"},Ds={for:""},As={for:""},qs={key:0,class:"eror"},Vs=O({__name:"loginPage",setup(x){const m=Q({login:null,password:null}),h=ce(),s=X(),l=b(null);async function p(u){var n;u.preventDefault(),l.value=null;try{const c=await T.post("/auth/login",m);(c.status===201||c.status===200)&&(h.setUser(c.data.user),s.push("/")),console.log(c.data)}catch(c){l.value=((n=c.response)==null?void 0:n.data.message)??"Ошибка при авторизации",console.error(c)}}return(u,n)=>(i(),f("div",Es,[n[6]||(n[6]=e("div",{class:"left"},null,-1)),e("div",Ms,[n[5]||(n[5]=e("h1",null,"Добро пожаловать на OnboardMe!",-1)),e("form",{onSubmit:p},[e("label",Ds,[n[2]||(n[2]=C(" Логин ")),R(e("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>m.login=c),type:"text",placeholder:"Введите свой логин"},null,512),[[D,m.login]])]),e("label",As,[n[3]||(n[3]=C(" Пароль ")),R(e("input",{"onUpdate:modelValue":n[1]||(n[1]=c=>m.password=c),type:"password",placeholder:"Введите свой пароль"},null,512),[[D,m.password]])]),l.value?(i(),f("span",qs,$(l.value),1)):U("",!0),n[4]||(n[4]=e("button",{type:"submit",class:"light-blue-btn"},"Войти",-1))],32)])]))}}),Ls=N(Vs,[["__scopeId","data-v-ff417032"]]),Ns={class:"stagesPage container dark-blue-container"},Fs={key:1,class:"error"},Os={key:2,class:"stages"},Bs=["onMouseover","onMouseleave"],zs={class:"stage-circle"},js={class:"stage-label"},Js={class:"tasks"},Gs={key:0,class:"task-link"},Ws=O({__name:"stagesPage",setup(x){const m=b([]),h=b(!0),s=b(null),l=ce(),p=F(()=>{var a;return((a=l.currentUser)==null?void 0:a.id)||null}),u=F(()=>{var a;return((a=l.currentUser)==null?void 0:a.name)||"Неизвестно"});async function n(){var a;if(!p.value){s.value="Информация о стажере отсутствует.",h.value=!1;return}try{const o=await T.get(`/stages/interns/${p.value}`);m.value=o.data.stages.map(g=>({id:g.id,number:g.number,name:g.name,tasks:g.tasks.map(r=>({id:r.id,number:r.number||r.id,name:r.name}))||[],showTasks:!1,internId:g.internId})),console.log("Stages fetched for intern:",p.value,m.value)}catch(o){console.error(o),s.value=((a=o.response)==null?void 0:a.data.message)||"Не удалось загрузить этапы."}finally{h.value=!1}}J(async()=>{await n()});const c=a=>{m.value[a].showTasks=!0},t=a=>{m.value[a].showTasks=!1},y=F(()=>m.value);return(a,o)=>{const g=Je("dragscroll");return R((i(),f("div",Ns,[e("h1",null,"Этапы онбординга для стажера "+$(u.value),1),h.value?(i(),G(pe,{key:0})):U("",!0),s.value?(i(),f("div",Fs,$(s.value),1)):U("",!0),!h.value&&!s.value?(i(),f("div",Os,[o[0]||(o[0]=e("div",{class:"roadmap-line"},null,-1)),(i(!0),f(L,null,B(y.value,(r,_)=>(i(),f("div",{key:_,class:"stage",onMouseover:d=>c(_),onMouseleave:d=>t(_)},[e("div",zs,$(r.number),1),e("div",js,$(r.name),1),R(e("div",Js,[r.tasks.length?U("",!0):(i(),f("div",Gs,"Нет задач")),r.tasks.length?(i(!0),f(L,{key:1},B(r.tasks,(d,v)=>(i(),f("div",{key:v,class:"task"},[P(M(Z),{to:`/stages/${r.id}/tasks/${d.id}`,class:"task-link"},{default:j(()=>[e("b",null,$(d.number)+".",1),C(" "+$(d.name),1)]),_:2},1032,["to"])]))),128)):U("",!0)],512),[[je,r.showTasks]])],40,Bs))),128))])):U("",!0)])),[[g,!0,void 0,{x:!0}]])}}}),Ks=N(Ws,[["__scopeId","data-v-aa974df1"]]),Ys={class:"border-shadow"},Xs=O({__name:"StatusCard",props:{status:{}},setup(x){Ae(u=>({"506b1ca1":l.value,cfab0004:p.value[0],cfaaffc6:p.value[1],cfaaff88:p.value[2]}));const m=x,h=F(()=>{switch(m.status){case"NOT_STARTED":case"HAS_STARTED":case"DONE":case"EXPIRED":return m.status;default:return"NOT_STARTED"}}),s=F(()=>{switch(h.value){case"NOT_STARTED":return"Не начато";case"HAS_STARTED":return"В процессе";case"DONE":return"Завершено";case"EXPIRED":return"Просрочено";default:return"Неизвестно"}}),l=F(()=>{switch(h.value){case"NOT_STARTED":return"#d9d9d9";case"HAS_STARTED":return"#ff00dd";case"DONE":return"#00ff88";case"EXPIRED":return"#ff0000";default:return"#c4c4c4"}}),p=F(()=>{const u=l.value.replace("#","").replace("var(--","").replace(")",""),n=parseInt(u.substring(0,2)||"c4",16),c=parseInt(u.substring(2,4)||"c4",16),t=parseInt(u.substring(4,6)||"c4",16);return[n,c,t]});return(u,n)=>(i(),f("div",Ys,[e("span",{style:De({color:l.value})},$(s.value),5)]))}}),Re=N(Xs,[["__scopeId","data-v-128a8f24"]]),Qs={class:"taskPage container"},Zs={key:1,class:"error"},en={key:2,class:"task dark-blue-container"},tn={class:"back-btn"},sn={class:"title"},nn={key:0,class:"profile"},an=["src"],on={class:"name"},ln={key:1},rn={class:"desc dark-blue-container"},un={class:"statistics"},dn={key:2,class:"status-btn done",disabled:""},cn=O({__name:"taskPage",setup(x){const m=ae(),h=X(),s=b(null),l=b(!0),p=b(null),u=ce(),n=F(()=>{var g;return((g=u.currentUser)==null?void 0:g.id)||null}),c=F(()=>m.params.stageId),t=F(()=>m.params.id),y=g=>F(()=>{const r=new Date(g),_=String(r.getDate()).padStart(2,"0"),d=String(r.getMonth()+1).padStart(2,"0"),v=r.getFullYear();return`${_}.${d}.${v}`});async function a(){var g;if(!n.value||!c.value||!t.value){p.value="Информация о задаче, этапе или стажере отсутствует.",l.value=!1,console.log("Missing params:",{internId:n.value,stageId:c.value,taskId:t.value});return}try{console.log("Fetching task from:",`/stages/${c.value}/tasks/${t.value}`);const r=await T.get(`/stages/${c.value}/tasks/${t.value}`);s.value=r.data.task,console.log("Task fetched:",s.value)}catch(r){console.error(r),p.value=((g=r.response)==null?void 0:g.data.message)||"Не удалось загрузить задачу."}finally{l.value=!1}}async function o(g){var r,_;if((r=s.value)!=null&&r.id)try{await T.post(`/stages/${c.value}/tasks/${s.value.id}/status`,{status:g}),s.value&&(s.value.status=g),console.log(`Status updated to: ${g}`)}catch(d){console.error(d),p.value=((_=d.response)==null?void 0:_.data.message)||"Не удалось обновить статус."}}return J(()=>{a()}),(g,r)=>{var _,d,v;return i(),f("div",Qs,[l.value?(i(),G(pe,{key:0})):U("",!0),p.value?(i(),f("div",Zs,$(p.value),1)):U("",!0),!l.value&&!p.value&&s.value?(i(),f("div",en,[e("div",tn,[e("button",{onClick:r[0]||(r[0]=k=>M(h).go(-1))},r[3]||(r[3]=[e("img",{src:"",alt:""},null,-1)])),e("div",sn,[e("h2",null,$(`Задание ${s.value.number}: ${s.value.name}`),1),P(Re,{status:s.value.status,class:"status"},null,8,["status"]),e("span",null,"до "+$(y(s.value.deadline)),1)])]),e("div",null,[r[4]||(r[4]=e("h4",null,"Ответственный:",-1)),s.value.stage.createdBy?(i(),f("div",nn,[e("img",{src:s.value.stage.createdBy.avatar||"/img/noimage.jpg",alt:"Mentor Avatar",class:"avatar"},null,8,an),e("div",on,$(s.value.stage.createdBy.name),1),s.value.stage.createdBy.position?(i(),G(W,{key:0,text:s.value.stage.createdBy.position.name,color:s.value.stage.createdBy.position.color,class:"textcard"},null,8,["text","color"])):U("",!0),P(W,{text:s.value.stage.createdBy.role,color:"#adff2f",class:"textcard"},null,8,["text"])])):(i(),f("p",ln,"Ответственный не назначен"))])])):U("",!0),r[7]||(r[7]=e("div",{class:"attachments dark-blue-container"},[e("h4",null,"Вложения"),e("h1",null,"в разработке")],-1)),e("div",rn,[r[5]||(r[5]=e("h4",null,"Описание",-1)),e("p",null,$((_=s.value)==null?void 0:_.desc),1)]),r[8]||(r[8]=e("div",{class:"comments dark-blue-container"},[e("h4",null,"Комментарии"),e("h1",null,"в разработке")],-1)),e("div",un,[r[6]||(r[6]=e("div",{class:"dark-blue-container"},[e("h1",null,"в разработке")],-1)),((d=s.value)==null?void 0:d.status)==="NOT_STARTED"?(i(),f("button",{key:0,class:"status-btn",onClick:r[1]||(r[1]=k=>o("HAS_STARTED"))}," Начать ")):((v=s.value)==null?void 0:v.status)==="HAS_STARTED"?(i(),f("button",{key:1,class:"status-btn active",onClick:r[2]||(r[2]=k=>o("DONE"))}," Завершить ")):(i(),f("button",dn,"Завершено"))])])}}}),pn=N(cn,[["__scopeId","data-v-206c3739"]]),mn={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function vn(x,m){return i(),f("svg",mn,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"m3.4 20.4 17.45-7.48a1 1 0 0 0 0-1.84L3.4 3.6a.993.993 0 0 0-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const fn={render:vn},gn={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function hn(x,m){return i(),f("svg",gn,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"#323232",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const _n={render:hn},yn={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function bn(x,m){return i(),f("svg",yn,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"currentColor",d:"M16.5 6.75v10.58c0 2.09-1.53 3.95-3.61 4.15A3.993 3.993 0 0 1 8.5 17.5V5.14c0-1.31.94-2.5 2.24-2.63A2.5 2.5 0 0 1 13.5 5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6.75c0-.41-.34-.75-.75-.75s-.75.34-.75.75v8.61c0 1.31.94 2.5 2.24 2.63A2.5 2.5 0 0 0 15 15.5V5.17c0-2.09-1.53-3.95-3.61-4.15A4 4 0 0 0 7 5v12.27c0 2.87 2.1 5.44 4.96 5.71 3.29.3 6.04-2.26 6.04-5.48V6.75c0-.41-.34-.75-.75-.75s-.75.34-.75.75"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const $n={render:bn},kn={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"};function wn(x,m){return i(),f("svg",kn,m[0]||(m[0]=[e("g",{"clip-path":"url(#a)"},[e("path",{fill:"red",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2zM9 9h6c.55 0 1 .45 1 1v8c0 .55-.45 1-1 1H9c-.55 0-1-.45-1-1v-8c0-.55.45-1 1-1m6.5-5-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z"})],-1),e("defs",null,[e("clipPath",{id:"a"},[e("path",{fill:"#fff",d:"M0 0h24v24H0z"})])],-1)]))}const Ee={render:wn},In={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 30 30"};function xn(x,m){return i(),f("svg",In,m[0]||(m[0]=[e("path",{fill:"currentColor",d:"M13.125 0H3.75v30h22.5V13.125H13.125z"},null,-1),e("path",{fill:"currentColor",d:"M16.875 0v9.375h9.375z"},null,-1)]))}const Cn={render:xn},Tn={class:"chatPage"},Sn={class:"sidebar-chat dark-blue-container"},Pn={key:1,class:"mini-chats"},Rn=["onClick"],Un=["src"],Hn={class:"content"},En={class:"name"},Mn={key:0,class:"group-indicator"},Dn={key:0,class:"last-msg"},An=["onClick"],qn=["src"],Vn={class:"content"},Ln={class:"name"},Nn={class:"edit-profile dark-blue-container"},Fn={key:0,class:"profile"},On=["src"],Bn={class:"names"},zn={class:"name"},jn={class:"chat-container dark-blue-container"},Jn={class:"messages"},Gn=["onMouseover"],Wn={key:0,class:"file-message"},Kn=["href"],Yn={class:"file-name"},Xn={key:1,class:"content"},Qn={class:"message-text"},Zn={class:"timestamp"},ea={key:2,class:"message-actions"},ta=["onClick"],sa=["onClick"],na={key:0,class:"attached-file"},aa={class:"file-name"},oa=["disabled"],la={class:"attach"},ra={class:"send",type:"submit"},ia={key:1,class:"chat-window empty-chat"},ua=O({__name:"chatPage",setup(x){const m=X(),h=ae(),s=ce(),l=F(()=>{var I;return((I=s.currentUser)==null?void 0:I.id)||""}),p=b(""),u=b([]),n=b([]),c=b(null),t=b(!0),y=b(null),a=b(null),o=b(null),g=b(""),r=b([]),_=b(!1),d=I=>`http://localhost:5050/api/download/chats/${I.split("/").pop()}`,v=at("http://localhost:4000",{withCredentials:!1}),k=F(()=>c.value&&n.value.find(I=>I.id===c.value)||null),w=F(()=>{if(!k.value)return null;const I=k.value.participants.find(S=>S.id!==l.value);return console.log("Other participant:",I),I||null}),E=F(()=>{if(!g.value.trim())return n.value;const I=g.value.toLowerCase();return n.value.filter(S=>{var V;const A=S.participants.map(Y=>Y.name.toLowerCase()).join(" "),K=((V=S.groupName)==null?void 0:V.toLowerCase())||"";return A.includes(I)||K.includes(I)})}),te=F(()=>r.value.filter(I=>!n.value.some(S=>S.participants.some(A=>A.id===I.id))&&I.id!==l.value));function re(I,S){let A;return function(...K){clearTimeout(A),A=setTimeout(()=>I.apply(this,K),S)}}async function ie(){if(!g.value.trim()){r.value=[];return}_.value=!0;try{const{data:I}=await T.get("/chats/search-users",{params:{query:g.value}});r.value=Array.from(new Map(I.users.map(S=>[S.id,S])).values())}catch(I){console.error("Ошибка поиска пользователей:",I),r.value=[]}finally{_.value=!1}}const ue=re(ie,300);async function se(I){var S;try{const K=(await T.post("/chats",{participants:[{userId:l.value,role:((S=s.currentUser)==null?void 0:S.role)||"INTERN"},{userId:I.id,role:I.role}]})).data.chat.id;c.value=K,await oe(K),v.emit("joinChat",K),m.push(`/chats/${K}`)}catch(A){console.error("Ошибка при создании чата:",A)}}const $e=async()=>{try{if(console.log("Current User ID from store:",l.value),!l.value){console.error("currentUserId is undefined or null"),t.value=!1;return}const I=await T.get(`/chats/for-user/${l.value}`,{withCredentials:!0});n.value=I.data.chats,console.log("Fetched chats:",n.value),!c.value&&n.value.length?(c.value=n.value[0].id,await oe(c.value),m.push(`/chats/${c.value}`)):h.params.id&&n.value.some(S=>S.id===h.params.id)&&(c.value=h.params.id,await oe(c.value))}catch(I){console.error("Ошибка загрузки чатов:",I)}finally{t.value=!1}},oe=async I=>{var S;try{console.log("Fetching messages for chat:",I);const A=await T.get(`/chats/${I}/messages`);u.value=A.data.messages||[],console.log("Fetched messages for chat",I,":",u.value),he()}catch(A){console.error("Ошибка загрузки сообщений:",A),((S=A.response)==null?void 0:S.status)===404&&(u.value=[],console.log("No messages or chat not found for",I))}},ge=async I=>{c.value!==I&&(c.value=I,console.log("Selected chat:",c.value),await oe(I),v.emit("joinChat",I),m.push(`/chats/${I}`))},qe=I=>{var A;const S=I.target;(A=S.files)!=null&&A[0]&&(y.value=S.files[0],p.value="")},Ve=()=>{y.value=null;const I=document.querySelector(".attach-input");I&&(I.value="")},Le=I=>{I.senderId===l.value&&(a.value={id:I.id,originalContent:I.content},p.value=I.content,y.value=null)},Ue=()=>{a.value=null,p.value="",y.value=null},Ne=I=>{confirm("Вы уверены, что хотите удалить сообщение?")&&T.delete(`/chats/${c.value}/messages/${I}`,{withCredentials:!0}).then(()=>{u.value=u.value.filter(S=>S.id!==I)}).catch(S=>{var A;console.error("Ошибка удаления:",((A=S.response)==null?void 0:A.data)||S.message)})},Fe=async()=>{var I;if(!(!c.value||!confirm("Вы уверены, что хотите удалить этот чат?")))try{await T.delete(`/chats/${c.value}`,{withCredentials:!0}),n.value=n.value.filter(S=>S.id!==c.value),u.value=[],c.value=n.value.length>0?n.value[0].id:null,c.value?(await oe(c.value),m.push(c.value?`/chats/${c.value}`:"/chats")):m.push("/chats")}catch(S){console.error("Ошибка удаления чата:",((I=S.response)==null?void 0:I.data)||S.message)}},Oe=async()=>{var I,S,A,K;if(!p.value.trim()&&!y.value||!c.value){console.error("Сообщение не может быть пустым или чат не выбран");return}if(a.value)v.emit("editMessage",{chatId:c.value,messageId:a.value.id,content:p.value.trim()},V=>{if(V!=null&&V.success){const Y=u.value.findIndex(ne=>{var H;return ne.id===((H=a.value)==null?void 0:H.id)});Y!==-1&&(u.value[Y].content=p.value.trim()),Ue()}else console.error("Ошибка редактирования:",V==null?void 0:V.error)});else if(y.value){const V=new FormData;V.append("chatId",c.value),V.append("senderId",l.value),V.append("senderRole",((I=s.currentUser)==null?void 0:I.role)||"INTERN"),V.append("file",y.value);try{console.log("Sending FormData:",Object.fromEntries(V));const Y=await T.post(`/chats/${c.value}/messages/upload`,V,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),ne={id:Y.data.messageId,content:Y.data.fileUrl,fileName:y.value.name,senderId:l.value,senderRole:((S=s.currentUser)==null?void 0:S.role)||"INTERN",createdAt:new Date,chatId:c.value};u.value.some(H=>H.id===ne.id)||(u.value.push(ne),he()),p.value="",y.value=null}catch(Y){console.error("Ошибка отправки файла:",((A=Y.response)==null?void 0:A.data)||Y.message)}}else v.emit("sendMessage",{chatId:c.value,senderId:l.value,senderRole:((K=s.currentUser)==null?void 0:K.role)||"INTERN",content:p.value.trim()},V=>{var Y;if(V!=null&&V.success){if(console.log("Message sent successfully, ID:",V.messageId),!u.value.some(ne=>ne.id===V.messageId)){const ne={id:V.messageId,content:p.value.trim(),senderId:l.value,senderRole:((Y=s.currentUser)==null?void 0:Y.role)||"INTERN",createdAt:new Date,chatId:c.value};u.value.push(ne),he()}p.value="",y.value=null}else console.error("Ошибка отправки сообщения:",V==null?void 0:V.error)})},he=()=>{We(()=>{const I=document.querySelector(".chat-container");I&&(I.scrollTop=I.scrollHeight)})};return J(async()=>{if(console.log("User Store:",s.currentUser),!l.value)return;await $e(),v.on("connect",()=>{v.emit("newUser",l.value)});const I=S=>{S.chatId===c.value&&!u.value.some(A=>A.id===S.id)&&(u.value.push(S),he())};v.on("getMessage",I),v.on("messageDeleted",S=>{u.value=u.value.filter(A=>A.id!==S.messageId)}),v.on("messageEdited",S=>{const A=u.value.findIndex(K=>K.id===S.messageId);A!==-1&&(u.value[A].content=S.content)}),v.connect()}),Ge(()=>{v.off("getMessage"),v.disconnect()}),ve(u,he),(I,S)=>{var A,K,V,Y,ne;return i(),f("div",Tn,[e("div",Sn,[S[4]||(S[4]=e("h4",null,"Чаты",-1)),R(e("input",{type:"text","onUpdate:modelValue":S[0]||(S[0]=H=>g.value=H),onInput:S[1]||(S[1]=(...H)=>M(ue)&&M(ue)(...H)),placeholder:"Поиск пользователей",class:"search-input"},null,544),[[D,g.value]]),t.value||_.value?(i(),G(pe,{key:0})):(i(),f("div",Pn,[(i(!0),f(L,null,B(E.value,H=>{var de,He;return i(),f("div",{key:H.id,class:ke(["mini-chat",{active:H.id===c.value}]),onClick:jl=>ge(H.id)},[e("img",{src:((de=H.participants[0])==null?void 0:de.avatar)||"/img/noimage.jpg",alt:""},null,8,Un),e("div",Hn,[e("div",En,[C($(H.groupName||((He=H.participants[0])==null?void 0:He.name)||"Без имени")+" ",1),H.participants.length>1?(i(),f("span",Mn," ("+$(H.participants.length)+") ",1)):U("",!0)]),H.lastMessage?(i(),f("div",Dn,$(H.lastMessage.length>10?H.lastMessage.substring(0,10)+"...":H.lastMessage),1)):U("",!0)])],10,Rn)}),128)),(i(!0),f(L,null,B(te.value,H=>(i(),f("div",{key:H.id,class:"mini-chat",onClick:de=>se(H)},[e("img",{src:H.avatar||"/img/noimage.jpg",alt:""},null,8,qn),e("div",Vn,[e("div",Ln,$(H.name),1)])],8,An))),128))]))]),k.value&&!t.value?(i(),f("div",{class:"chat-window",key:c.value||""+Date.now()},[e("div",Nn,[k.value?(i(),f("div",Fn,[e("img",{src:((A=w.value)==null?void 0:A.avatar)||"/img/noimage.jpg",alt:""},null,8,On),e("div",Bn,[e("div",zn,[C($(k.value.groupName||((K=w.value)==null?void 0:K.name)||"Без имени")+" ",1),(V=w.value)!=null&&V.position?(i(),G(W,{key:0,color:"#0075FF",text:w.value.position},null,8,["text"])):U("",!0),(Y=w.value)!=null&&Y.role?(i(),G(W,{key:1,color:"#adff2f",text:w.value.role},null,8,["text"])):U("",!0)])])])):U("",!0),e("button",{class:"delete-chat",onClick:Fe},[P(M(Ee))])]),e("div",jn,[e("div",Jn,[(i(!0),f(L,null,B(u.value,H=>(i(),f("div",{key:H.id,class:ke(["message",{sent:H.senderId===l.value,received:H.senderId!==l.value}]),onMouseover:de=>o.value=H.id,onMouseleave:S[2]||(S[2]=de=>o.value=null)},[H.content.includes("/uploads/")?(i(),f("div",Wn,[e("a",{href:d(H.content),download:"",class:"file-link"},[P(M(Cn)),e("span",Yn,$(H.fileName),1)],8,Kn)])):(i(),f("div",Xn,[e("div",Qn,$(H.content),1)])),e("div",Zn,$(new Date(H.createdAt).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})),1),o.value===H.id&&H.senderId===l.value?(i(),f("div",ea,[e("button",{onClick:de=>Le(H),class:"action-btn"},[P(M(be))],8,ta),e("button",{onClick:de=>Ne(H.id),class:"action-btn"},[P(M(Ee))],8,sa)])):U("",!0)],42,Gn))),128))])]),e("form",{onSubmit:q(Oe,["prevent"])},[y.value?(i(),f("div",na,[e("span",aa,$(y.value.name),1),e("button",{type:"button",class:"remove-file",onClick:Ve},[P(M(_n))])])):U("",!0),R(e("input",{"onUpdate:modelValue":S[3]||(S[3]=H=>p.value=H),type:"text",disabled:!!y.value,placeholder:"Введите сообщение..."},null,8,oa),[[D,p.value]]),e("label",la,[P(M($n)),e("input",{type:"file",class:"attach-input",onChange:qe},null,32)]),a.value?(i(),f("button",{key:1,type:"button",class:"cancel-btn",onClick:Ue}," Отмена ")):U("",!0),e("button",ra,[P(M(fn))])],32)])):t.value?U("",!0):(i(),f("div",ia,$((ne=n.value)!=null&&ne.length?"Чат не найден, выберите другой":"Нет доступных чатов"),1))])}}}),da=N(ua,[["__scopeId","data-v-70a7ccdf"]]),ca={class:"registerPage"},pa={class:"right"},ma={key:0,class:"error"},va=O({__name:"registerPage",setup(x){const m=X(),h=b(null),s=Q({login:"",email:"",name:"",password:"",secretKey:""});async function l(p){var n;if(p.preventDefault(),h.value=null,!s.login.trim())return h.value="Логин обязателен";if(!s.name.trim())return h.value="Имя обязательно";if(!s.email.trim())return h.value="Почта обязательна";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email))return h.value="Некорректный email";if(!s.password||s.password.length<6)return h.value="Пароль должен быть не менее 6 символов";if(!s.secretKey.trim())return h.value="Секретный ключ обязателен";try{(await T.post("/auth/register",s)).status===201&&m.push("/login")}catch(c){h.value=((n=c.response)==null?void 0:n.data.message)??"Ошибка при регистрации",console.error(c)}}return(p,u)=>(i(),f("div",ca,[u[12]||(u[12]=e("div",{class:"left"},null,-1)),e("div",pa,[u[11]||(u[11]=e("h1",null,"Добро пожаловать на OnboardMe!",-1)),e("form",{onSubmit:l},[e("label",null,[u[5]||(u[5]=C(" Логин ")),R(e("input",{"onUpdate:modelValue":u[0]||(u[0]=n=>s.login=n),type:"text",placeholder:"Введите свой логин",required:""},null,512),[[D,s.login]])]),e("label",null,[u[6]||(u[6]=C(" Почта ")),R(e("input",{"onUpdate:modelValue":u[1]||(u[1]=n=>s.email=n),type:"email",placeholder:"Введите свою почту",required:""},null,512),[[D,s.email]])]),e("label",null,[u[7]||(u[7]=C(" Имя ")),R(e("input",{"onUpdate:modelValue":u[2]||(u[2]=n=>s.name=n),type:"text",placeholder:"Введите свое имя",required:""},null,512),[[D,s.name]])]),e("label",null,[u[8]||(u[8]=C(" Пароль ")),R(e("input",{"onUpdate:modelValue":u[3]||(u[3]=n=>s.password=n),type:"password",placeholder:"Введите свой пароль",required:"",minlength:"6"},null,512),[[D,s.password]])]),e("label",null,[u[9]||(u[9]=C(" Секретный ключ ")),R(e("input",{"onUpdate:modelValue":u[4]||(u[4]=n=>s.secretKey=n),type:"password",placeholder:"Введите секретный ключ",required:""},null,512),[[D,s.secretKey]])]),u[10]||(u[10]=e("button",{type:"submit",class:"light-blue-btn"},"Зарегистрироваться",-1)),h.value?(i(),f("span",ma,$(h.value),1)):U("",!0)],32)])]))}}),fa=N(va,[["__scopeId","data-v-a4666905"]]),ga={for:""},ha={for:""},_a={for:""},ya={for:""},ba={for:""},$a={class:"custom-select"},ka=["value"],wa={for:""},Ia={class:"custom-select"},xa=["value"],Ca={key:0,class:"error"},Ta=O({__name:"addInternPage",setup(x){const m=X(),h=b(null),s=b(null),l=b(null);async function p(){try{const y=await T.get("/positions");s.value=y.data.positions}catch(y){console.error(y)}}async function u(){try{const y=await T.get("/users/teamleads");console.log(y.data),l.value=y.data.teamleads}catch(y){console.error(y)}}J(async()=>{await p(),await u()});const n=Q({login:null,name:null,email:null,password:null,positionId:null,mentorId:null});function c(){h.value=null,m.push("/interns")}async function t(y){var o;if(y.preventDefault(),h.value=null,!n.login||!n.login.trim())return h.value="Логин обязателен";if(!n.name||!n.name.trim())return h.value="Имя обязательно";if(!n.email||!n.email.trim())return h.value="Почта обязательна";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email))return h.value="Некорректный email";if(!n.password||n.password.length<6)return h.value="Пароль должен быть не менее 6 символов";try{const g=await T.post("/users/interns",n);(g.status===201||g.status===200)&&(z.emit("reloadInterns"),m.push("/interns"))}catch(g){h.value=((o=g.response)==null?void 0:o.data.message)??"Ошибка при регистрации стажера",console.error(g)}}return(y,a)=>(i(),f("div",{onClick:q(c,["stop"]),class:"addInternPage"},[e("form",{onSubmit:t,onClick:a[6]||(a[6]=q(()=>{},["stop"])),action:"",class:"dark-blue-container"},[a[15]||(a[15]=e("h2",null,"Добавление стажера",-1)),e("label",ga,[a[7]||(a[7]=C(" Логин ")),R(e("input",{"onUpdate:modelValue":a[0]||(a[0]=o=>n.login=o),type:"text",required:""},null,512),[[D,n.login]])]),e("label",ha,[a[8]||(a[8]=C(" Имя ")),R(e("input",{"onUpdate:modelValue":a[1]||(a[1]=o=>n.name=o),type:"text",required:""},null,512),[[D,n.name]])]),e("label",_a,[a[9]||(a[9]=C(" Почта ")),R(e("input",{"onUpdate:modelValue":a[2]||(a[2]=o=>n.email=o),type:"email",required:""},null,512),[[D,n.email]])]),e("label",ya,[a[10]||(a[10]=C(" Пароль ")),R(e("input",{"onUpdate:modelValue":a[3]||(a[3]=o=>n.password=o),type:"password",required:""},null,512),[[D,n.password]])]),e("label",ba,[a[12]||(a[12]=C(" Должность ")),e("div",$a,[R(e("select",{"onUpdate:modelValue":a[4]||(a[4]=o=>n.positionId=o),name:"position",required:""},[a[11]||(a[11]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(s.value,o=>(i(),f("option",{value:o.id,key:o.id},$(o.name),9,ka))),128))],512),[[ee,n.positionId]])])]),e("label",wa,[a[14]||(a[14]=C(" Ментор ")),e("div",Ia,[R(e("select",{"onUpdate:modelValue":a[5]||(a[5]=o=>n.mentorId=o),name:"teamlead"},[a[13]||(a[13]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(l.value,o=>(i(),f("option",{value:o.id,key:o.id},$(o.name),9,xa))),128))],512),[[ee,n.mentorId]])])]),a[16]||(a[16]=e("button",{type:"submit",class:"form-btn"},"Зарегистрировать стажера",-1)),h.value?(i(),f("span",Ca,$(h.value),1)):U("",!0)],32)]))}}),Sa=N(Ta,[["__scopeId","data-v-c3ebac81"]]),Pa={class:"templatesPage container"},Ra={class:"dark-blue-container"},Ua={class:"cards"},Ha={class:"edit"},Ea=O({__name:"positionsPage",setup(x){const m=b(null);async function h(){try{const s=await T.get("/positions");m.value=s.data.positions}catch(s){console.error(s)}}return J(async()=>{await h(),z.on("reloadPositions",h)}),we(()=>{z.off("reloadPositions",h)}),(s,l)=>{const p=ye("RouterLink");return i(),f("div",Pa,[e("div",Ra,[l[1]||(l[1]=e("h2",null,"Управление должностями",-1)),e("div",Ua,[(i(!0),f(L,null,B(m.value,u=>(i(),G(p,{to:`/positions/update/${u.id}`,class:"card",key:u.id},{default:j(()=>[P(W,{color:u.color,text:u.name},null,8,["color","text"]),e("div",Ha,[P(M(be))])]),_:2},1032,["to"]))),128))]),P(p,{to:"/positions/add"},{default:j(()=>l[0]||(l[0]=[e("button",{class:"light-blue-btn"},"Добавить должность",-1)])),_:1,__:[0]})])])}}}),Se=N(Ea,[["__scopeId","data-v-c1ff497a"]]),Ma={for:""},Da={key:0,class:"error"},Aa=O({__name:"addPositionPage",setup(x){const m=X(),h=b(null);async function s(n){n.preventDefault(),h.value=null;try{if(!p.name||!p.color)throw h.value="Название или цвет должности не выбраны!",new Error("Данные заполнены не полностью!");await T.post("/positions",{name:p.name.trim(),color:p.color.trim()})&&(z.emit("reloadPositions"),m.push("/positions"))}catch(c){c.response&&(h.value=c.response.data.message),console.error(c)}}function l(){m.push("/positions"),p.color="",p.name="",h.value=null}const p=Q({color:"",name:""}),u=Q({color:"#fa0202",name:"Должность"});return ve(p,()=>{u.color=p.color,u.name=p.name,u.name===""&&(u.name="Должность",u.color="#fa0202")}),(n,c)=>{const t=ye("ColorPicker");return i(),f("div",{onClick:q(l,["stop"]),class:"addPositionPage"},[e("div",{onClick:c[2]||(c[2]=q(()=>{},["stop"])),class:"modal-container dark-blue-container"},[c[4]||(c[4]=e("h2",null,"Добавление должности",-1)),e("form",{onSubmit:s},[e("label",Ma,[P(t,{pureColor:p.color,"onUpdate:pureColor":c[0]||(c[0]=y=>p.color=y),shape:"circle",format:"hex","picker-type":"chrome",theme:"black"},null,8,["pureColor"]),R(e("input",{type:"text","onUpdate:modelValue":c[1]||(c[1]=y=>p.name=y),placeholder:"Название должности"},null,512),[[D,p.name]])]),c[3]||(c[3]=e("button",{type:"submit",class:"form-btn"},"Добавить должность",-1)),h.value?(i(),f("span",Da,$(h.value),1)):U("",!0)],32),c[5]||(c[5]=e("h4",null,"Превью",-1)),P(W,{color:u.color,text:u.name,class:"preview"},null,8,["color","text"])])])}}}),qa=N(Aa,[["__scopeId","data-v-cbb78f7f"]]),Va={for:""},La={key:0,class:"error"},Na=O({__name:"managePositionPage",setup(x){const m=X(),h=ae(),s=b(null),l=b(null),p=b(null),u=Q({color:"",name:""}),n=Q({});J(async()=>{var o;const a=h.params.id;try{if(typeof a!="string")throw new Error("Недопустимый тип ID!");s.value=a,console.log(s.value);const g=await T.get(`/positions/${s.value}`);p.value=g.data.position,console.log(p.value),p.value&&(u.name=p.value.name,u.color=p.value.color)}catch(g){console.error(g),l.value=((o=g.response)==null?void 0:o.data.message)??"Не удалось загрузить должность"}});function c(){m.push("/positions"),l.value=null}async function t(a){var o;if(a.preventDefault(),l.value=null,!!p.value){if(n.name=void 0,n.color=void 0,u.name.trim()&&u.name.trim()!==p.value.name&&(n.name=u.name.trim()),u.color.trim()&&u.color.trim()!==p.value.color&&(n.color=u.color.trim()),!n.name&&!n.color)return m.push("/positions");try{await T.put(`/positions/${s.value}`,n)&&(z.emit("reloadPositions"),m.push("/positions"))}catch(g){l.value=((o=g.response)==null?void 0:o.data.message)??"Ошибка обновления",console.error(g)}}}async function y(a){var o;if(a.preventDefault(),l.value=null,!!p.value)try{await T.delete(`/positions/${s.value}`)&&m.push("/positions")}catch(g){l.value=((o=g.response)==null?void 0:o.data.message)??"Ошибка удаления",console.error(g)}}return(a,o)=>{const g=ye("ColorPicker");return i(),f("div",{onClick:q(c,["stop"]),class:"managePositionPage"},[e("div",{onClick:o[2]||(o[2]=q(()=>{},["stop"])),class:"modal-container dark-blue-container"},[o[4]||(o[4]=e("h2",null,"Изменение должности",-1)),e("form",{onSubmit:t},[e("label",Va,[P(g,{pureColor:u.color,"onUpdate:pureColor":o[0]||(o[0]=r=>u.color=r),shape:"circle",format:"hex","picker-type":"chrome",theme:"black"},null,8,["pureColor"]),R(e("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=r=>u.name=r),placeholder:"Название должности"},null,512),[[D,u.name]])]),o[3]||(o[3]=e("button",{type:"submit",class:"form-btn"},"Обновить должность",-1)),l.value?(i(),f("span",La,$(l.value),1)):U("",!0),e("button",{onClick:q(y,["stop"]),class:"red-btn"},"Удалить")],32),o[5]||(o[5]=e("h4",null,"Превью",-1)),P(W,{color:u.color,text:u.name,class:"preview"},null,8,["color","text"])])])}}}),Fa=N(Na,[["__scopeId","data-v-a0668a1d"]]),Oa={class:"teamleadsPage dark-blue-container"},Ba={class:"buttons"},za={key:0,class:"error"},ja={class:"teamleads-table"},Ja=["onClick"],Ga={class:"profile"},Wa=["src","alt"],Ka={class:"names"},Ya={class:"textcard"},Xa={class:"textcard"},Qa={class:"status"},Za={key:0,class:"status-online"},eo={key:1,class:"status-offline"},to={class:""},so={class:""},no={class:"interactions"},ao={class:"icon"},oo={class:"icon"},lo=O({__name:"teamleadsPage",setup(x){const m=b(null),h=b(null),s=b(!0);async function l(){try{const u=await T.get("/users/teamleads");m.value=u.data.teamleads,console.log("Teamleads fetched:",m.value)}catch(u){console.error(u),h.value="Ошибка при загрузке тимлидов"}finally{s.value=!1}}J(async()=>{await l(),z.on("reloadTeamleads",l)}),we(()=>{z.off("reloadTeamleads",l)});const p=u=>{Ie.push(`/teamleads/${u}`)};return(u,n)=>(i(),f("div",Oa,[n[4]||(n[4]=e("h2",null,"Тимлиды",-1)),e("div",Ba,[P(M(Z),{to:"/teamleads/add"},{default:j(()=>n[2]||(n[2]=[e("button",{class:"add"},"Добавить",-1)])),_:1,__:[2]})]),h.value?(i(),f("span",za,$(h.value),1)):U("",!0),e("table",ja,[n[3]||(n[3]=e("thead",null,[e("tr",null,[e("th",{class:""},"Сотрудник"),e("th",{class:""},"Должность"),e("th",{class:""},"Роль"),e("th",{class:""},"Статус"),e("th",{class:""},"Подопечные"),e("th",{class:""},"Дата регистрации"),e("th",{class:""},"Изменить")])],-1)),e("tbody",null,[s.value?(i(),G(pe,{key:0})):(i(!0),f(L,{key:1},B(m.value,c=>{var t,y,a;return i(),f("tr",{key:c.id,class:"teamlead",onClick:o=>p(c.id)},[e("td",Ga,[e("img",{src:c.avatar||"/img/noimage.jpg",alt:c.name},null,8,Wa),e("div",Ka,[e("span",null,$(c.name),1),e("span",null,$(c.login),1)])]),e("td",Ya,[P(W,{color:(t=c.position)==null?void 0:t.color,text:(y=c.position)==null?void 0:y.name},null,8,["color","text"])]),e("td",Xa,[P(W,{color:"#ffa500",text:"Тимлид"})]),e("td",Qa,[c.lastOnline&&new Date(c.lastOnline)>new Date(Date.now()-5*60*1e3)?(i(),f("button",Za," Online ")):(i(),f("button",eo," Offline "))]),e("td",to,$(((a=c.responsibleFor)==null?void 0:a.length)||0),1),e("td",so,$(new Date(c.createdAt).toLocaleDateString()),1),e("td",no,[P(M(Z),{onClick:n[0]||(n[0]=q(()=>{},["stop"])),to:`/chats/${c.id}`},{default:j(()=>[e("button",ao,[P(M(me))])]),_:2},1032,["to"]),P(M(Z),{onClick:n[1]||(n[1]=q(()=>{},["stop"])),to:`/teamleads/update/${c.id}`},{default:j(()=>[e("button",oo,[P(M(be))])]),_:2},1032,["to"])])],8,Ja)}),128))])])]))}}),Pe=N(lo,[["__scopeId","data-v-14acbf96"]]),ro={class:"onboardingControlPage dark-blue-container"},io={class:"buttons"},uo={key:0,class:"error"},co={class:"stages-table"},po={key:0},mo={colspan:"8",class:"loading-row"},vo=["onClick"],fo={key:1},go={class:"actions"},ho={key:0,class:"tasks-row"},_o={colspan:"8"},yo={class:"tasks-container"},bo={key:0,class:"tasks-list"},$o={class:"task-info"},ko={class:"task-name"},wo={class:"task-deadline"},Io={class:"task-actions"},xo={key:1,class:"no-tasks"},Co={class:"add-task-section"},To=O({__name:"onboardingControlPage",setup(x){const m=b(null),h=b(!0),s=b(null),l=b([]);async function p(){try{const y=await T.get("/stages");l.value=y.data.stages.map(a=>({id:a.id,number:a.number,name:a.name,status:a.status,startedAt:a.startedAt,endedAt:a.endedAt,internId:a.internId,createdFor:a.createdFor,tasks:a.tasks?a.tasks.map(o=>({id:o.id,number:o.number,name:o.name,status:o.status,deadline:o.deadline,stageId:o.stageId})):[]})),console.log(l.value),h.value=!1}catch(y){console.error("Ошибка загрузки этапов:",y),m.value="Не удалось загрузить этапы. Проверьте подключение или обратитесь к администратору."}}const u=y=>{s.value=s.value===y?null:y},n=F(()=>y=>{var a;return((a=y.tasks)==null?void 0:a.length)||0}),c=y=>y.createdFor||null,t=y=>y?[...y].sort((a,o)=>a.number-o.number):[];return J(async()=>{await p(),z.on("reloadStages",p)}),we(()=>{z.off("reloadStages",p)}),(y,a)=>(i(),f("div",ro,[a[9]||(a[9]=e("h1",null,"Управление онбордингами",-1)),e("div",io,[P(M(Z),{to:"/control/stages/add"},{default:j(()=>a[3]||(a[3]=[e("button",{class:"add"},"Добавить этап",-1)])),_:1,__:[3]})]),m.value?(i(),f("span",uo,$(m.value),1)):U("",!0),e("div",co,[e("table",null,[a[8]||(a[8]=e("thead",null,[e("tr",null,[e("th",null,"Номер"),e("th",null,"Название"),e("th",null,"Статус"),e("th",null,"Начато"),e("th",null,"Завершено"),e("th",null,"Для кого"),e("th",null,"Кол-во задач"),e("th",null,"Действия")])],-1)),e("tbody",null,[h.value?(i(),f("tr",po,[e("td",mo,[P(pe)])])):(i(!0),f(L,{key:1},B(l.value,o=>{var g;return i(),f(L,{key:o.id},[e("tr",{class:"stage-row",onClick:r=>u(o.id)},[e("td",null,$(o.number),1),e("td",null,$(o.name),1),e("td",null,[P(Re,{status:o.status},null,8,["status"])]),e("td",null,$(o.startedAt?new Date(o.startedAt).toLocaleDateString("ru-RU"):"Нету"),1),e("td",null,$(o.endedAt?new Date(o.endedAt).toLocaleDateString("ru-RU"):"Нету"),1),e("td",null,[c(o)?(i(),f(L,{key:0},[C($(((g=c(o))==null?void 0:g.name)||"Неизвестный стажер"),1)],64)):(i(),f("span",fo,"Не указан"))]),e("td",null,$(n.value(o)),1),e("td",go,[P(M(Z),{to:`/control/stages/${o.id}/update`,onClick:a[0]||(a[0]=q(()=>{},["stop"]))},{default:j(()=>a[4]||(a[4]=[e("button",{class:"edit-btn"},"Изменить",-1)])),_:2,__:[4]},1032,["to"])])],8,vo),s.value===o.id?(i(),f("tr",ho,[e("td",_o,[e("div",yo,[o.tasks&&o.tasks.length?(i(),f("div",bo,[(i(!0),f(L,null,B(t(o.tasks),r=>(i(),f("div",{key:r.id,class:"task-item"},[e("div",$o,[e("span",ko,$(r.number)+". "+$(r.name),1),P(Re,{status:r.status},null,8,["status"]),e("span",wo,"Дедлайн: "+$(r.deadline?new Date(r.deadline).toLocaleDateString("ru-RU"):"Нет"),1)]),e("div",Io,[P(M(Z),{to:`/control/tasks/${r.id}`,onClick:a[2]||(a[2]=q(()=>{},["stop"]))},{default:j(()=>[a[6]||(a[6]=e("button",{class:"task-btn"},"Предпросмотр",-1)),P(M(Z),{to:`/control/stages/${o.id}/tasks/${r.id}/update`,onClick:a[1]||(a[1]=q(()=>{},["stop"]))},{default:j(()=>a[5]||(a[5]=[e("button",{class:"edit-task-btn"},"Изменить",-1)])),_:2,__:[5]},1032,["to"])]),_:2,__:[6]},1032,["to"])])]))),128))])):(i(),f("div",xo," Нет задач для этого этапа ")),e("div",Co,[P(M(Z),{to:`/control/stages/${o.id}/tasks/add`,class:"add-task-link"},{default:j(()=>a[7]||(a[7]=[e("button",{class:"add-task-btn"},"Добавить задачу",-1)])),_:2,__:[7]},1032,["to"])])])])])):U("",!0)],64)}),128))])])])]))}}),_e=N(To,[["__scopeId","data-v-674ef630"]]),So={for:""},Po={for:""},Ro={for:""},Uo={class:"custom-select"},Ho=["value"],Eo={for:""},Mo={class:"custom-select"},Do=["value"],Ao={key:0,class:"error"},qo=O({__name:"addStage",setup(x){const m=X(),h=b(null),s=b(null),l=b(null),p=b(null);async function u(){try{const o=await T.get("/users/interns");s.value=o.data.interns}catch(o){console.error(o)}}async function n(){try{const o=await T.get("/users/teamleads");l.value=o.data.teamleads}catch(o){console.error(o)}}async function c(){try{const o=await T.get("/stages");p.value=o.data.stages}catch(o){console.error(o)}}J(async()=>{await Promise.all([u(),n(),c()])});const t=Q({number:null,name:null,internId:null,teamleadId:null});ve(()=>t.internId,o=>{if(o&&p.value){const g=p.value.filter(r=>r.internId===o);t.number=g.length+1}else t.number=null});function y(){h.value=null,m.push("/control")}async function a(o){var g;if(o.preventDefault(),h.value=null,!t.number)return h.value="Номер этапа обязателен";if(!t.name||!t.name.trim())return h.value="Название этапа обязательно";if(!t.internId)return h.value="Необходимо выбрать стажёра";try{(await T.post("/stages",{number:t.number,name:t.name,internId:t.internId,teamleadId:t.teamleadId})).status===201&&(z.emit("reloadStages"),m.push("/control"))}catch(r){h.value=((g=r.response)==null?void 0:g.data.message)??"Ошибка при создании этапа",console.error(r)}}return(o,g)=>(i(),f("div",{onClick:q(y,["stop"]),class:"addStagePage"},[e("form",{onSubmit:a,onClick:g[4]||(g[4]=q(()=>{},["stop"])),class:"dark-blue-container"},[g[11]||(g[11]=e("h2",null,"Создание этапа",-1)),e("label",So,[g[5]||(g[5]=C(" Номер этапа ")),R(e("input",{"onUpdate:modelValue":g[0]||(g[0]=r=>t.number=r),type:"number",min:"1",required:"",disabled:""},null,512),[[D,t.number,void 0,{number:!0}]])]),e("label",Po,[g[6]||(g[6]=C(" Название этапа ")),R(e("input",{"onUpdate:modelValue":g[1]||(g[1]=r=>t.name=r),type:"text",required:""},null,512),[[D,t.name]])]),e("label",Ro,[g[8]||(g[8]=C(" Стажёр ")),e("div",Uo,[R(e("select",{"onUpdate:modelValue":g[2]||(g[2]=r=>t.internId=r),required:""},[g[7]||(g[7]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(s.value,r=>(i(),f("option",{value:r.id,key:r.id},$(r.name)+" ("+$(r.login)+") ",9,Ho))),128))],512),[[ee,t.internId]])])]),e("label",Eo,[g[10]||(g[10]=C(" Тимлид ")),e("div",Mo,[R(e("select",{"onUpdate:modelValue":g[3]||(g[3]=r=>t.teamleadId=r)},[g[9]||(g[9]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(l.value,r=>(i(),f("option",{value:r.id,key:r.id},$(r.name)+" ("+$(r.login)+") ",9,Do))),128))],512),[[ee,t.teamleadId]])])]),g[12]||(g[12]=e("button",{type:"submit",class:"form-btn"},"Создать этап",-1)),h.value?(i(),f("span",Ao,$(h.value),1)):U("",!0)],32)]))}}),Vo=N(qo,[["__scopeId","data-v-6923b729"]]),Lo={for:""},No=["value"],Fo={for:""},Oo={for:""},Bo={for:""},zo={for:""},jo={class:"custom-select"},Jo=["value"],Go={key:0,class:"error"},Wo={key:1,class:"success"},Ko=O({__name:"addTaskPage",setup(x){const m=X(),h=ae(),s=b(null),l=b(null),p=b(null),u=b(null),n=b({}),c=h.params.stageId,t=Q({number:null,name:null,desc:null,deadline:null,stageId:c||null});async function y(){try{const _=await T.get("/stages");u.value=_.data.stages,console.log("Stages loaded:",_.data.stages),t.stageId&&u.value&&(u.value.find(v=>v.id===t.stageId)||await a(t.stageId))}catch(_){console.error("Error loading stages:",_)}}async function a(_){try{const d=await T.get(`/stages/${_}/tasks`);n.value[_]=d.data.tasks.length,console.log(`Tasks count for ${_}:`,n.value[_])}catch(d){console.error(`Error loading tasks for ${_}:`,d),n.value[_]=0}}J(async()=>{await y(),t.stageId&&(await a(t.stageId),t.number=o.value)});const o=F(()=>{if(!t.stageId)return null;const _=n.value[t.stageId]||0;return console.log(`Computed taskNumber for ${t.stageId}:`,_+1),_+1});ve(()=>t.stageId,async _=>{console.log("StageId changed to",_),_?(await a(_),t.number=o.value,console.log("Updated taskForm.number:",t.number)):(t.number=null,console.log("Cleared taskForm.number"))});function g(){s.value=null,l.value=null,p.value=null,m.push("/control")}async function r(_){var te,re,ie,ue;_.preventDefault(),s.value=null,l.value=null;const d=t.number||1,v=((te=t.name)==null?void 0:te.trim())||null,k=((re=t.desc)==null?void 0:re.trim())||null,w=t.deadline||null,E=t.stageId||null;if(!v)return s.value="Название задачи обязательно";if(!E)return s.value="Необходимо выбрать этап";if(!w)return s.value="Дедлайн обязателен";try{const se=await T.post(`/stages/${E}/tasks`,{number:d,name:v,desc:k,deadline:w,status:"NOT_STARTED"});console.log("Task created:",se.data.task),se.status===201&&(p.value=se.data.task,l.value=`Задача создана! Номер задачи: ${(ie=p.value)==null?void 0:ie.number}`,z.emit("reloadStages"),m.push("/control"))}catch(se){s.value=((ue=se.response)==null?void 0:ue.data.message)??"Ошибка при создании задачи",console.error("Error creating task:",se)}}return(_,d)=>(i(),f("div",{onClick:q(g,["stop"]),class:"addTaskPage"},[e("form",{onSubmit:q(r,["prevent"]),onClick:d[4]||(d[4]=q(()=>{},["stop"])),class:"dark-blue-container"},[d[11]||(d[11]=e("h2",null,"Создание задачи",-1)),e("label",Lo,[d[5]||(d[5]=C(" Номер задачи ")),e("input",{value:t.number,type:"number",readonly:"",required:""},null,8,No)]),e("label",Fo,[d[6]||(d[6]=C(" Название задачи ")),R(e("input",{"onUpdate:modelValue":d[0]||(d[0]=v=>t.name=v),type:"text",required:""},null,512),[[D,t.name]])]),e("label",Oo,[d[7]||(d[7]=C(" Описание ")),R(e("input",{"onUpdate:modelValue":d[1]||(d[1]=v=>t.desc=v),type:"text"},null,512),[[D,t.desc]])]),e("label",Bo,[d[8]||(d[8]=C(" Дедлайн ")),R(e("input",{"onUpdate:modelValue":d[2]||(d[2]=v=>t.deadline=v),type:"date",required:""},null,512),[[D,t.deadline]])]),e("label",zo,[d[10]||(d[10]=C(" Этап ")),e("div",jo,[R(e("select",{"onUpdate:modelValue":d[3]||(d[3]=v=>t.stageId=v),required:""},[d[9]||(d[9]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(u.value,v=>(i(),f("option",{value:v.id,key:v.id},$(v.name)+" (№"+$(v.number)+") ",9,Jo))),128))],512),[[ee,t.stageId]])])]),d[12]||(d[12]=e("button",{type:"submit",class:"form-btn"},"Создать задачу",-1)),s.value?(i(),f("span",Go,$(s.value),1)):U("",!0),l.value?(i(),f("span",Wo,$(l.value),1)):U("",!0)],32)]))}}),Yo=N(Ko,[["__scopeId","data-v-d2d48c97"]]),Xo={for:""},Qo={for:""},Zo={for:""},el={class:"custom-select"},tl=["value"],sl={for:""},nl={class:"custom-select"},al=["value"],ol={key:0,class:"error"},ll={key:1,class:"success"},rl=O({__name:"updateStagePage",setup(x){const m=ae(),h=X(),s=b(null),l=b(null),p=b(null),u=b(null),n=b(null);async function c(){var _;try{const d=await T.get("/users/interns");p.value=d.data.interns,console.log("Interns loaded:",d.data.interns)}catch(d){console.error(d),s.value=(_=d.response)==null?void 0:_.data.message}}async function t(){var _;try{const d=await T.get("/users/teamleads");u.value=d.data.teamleads,console.log("Teamleads loaded:",d.data.teamleads)}catch(d){console.error(d),s.value=(_=d.response)==null?void 0:_.data.message}}async function y(){var d;const _=m.params.stageId;console.log("Route params:",m.params);try{console.log(`Fetching stage with id: ${_}`);const v=await T.get(`/stages/${_}`);n.value=v.data.stage,console.log("Stage data received:",v.data.stage)}catch(v){console.error(v),s.value=((d=v.response)==null?void 0:d.data.message)||"Не удалось загрузить этап."}}J(async()=>{await c(),await t(),await y()});const a=Q({number:void 0,name:void 0,internId:void 0,teamleadId:void 0});ve(n,_=>{_&&(a.number=_.number,a.name=_.name,a.internId=_.internId,a.teamleadId=_.teamleadId,console.log("Stage form updated:",a))});async function o(){var d,v;const _=m.params.stageId;if(console.log("Deleting stage with id:",_),!_){s.value="Не удалось определить этап для удаления.";return}if(confirm("Вы уверены, что хотите удалить этот этап? Это действие нельзя отменить."))try{const k=await T.delete(`/stages/${_}`);console.log("Stage deleted response:",k.data),k.status===200&&(l.value="Этап успешно удален!",z.emit("reloadStages"),h.push("/control"))}catch(k){s.value=((d=k.response)==null?void 0:d.data.message)??"Ошибка при удалении этапа",console.error("Error deleting stage:",((v=k.response)==null?void 0:v.data)||k)}}async function g(_){var v;_.preventDefault(),s.value=null,l.value=null;const d=m.params.stageId;if(console.log("Updating stage with id:",d),!d){s.value="Не удалось определить этап для обновления.";return}if(!a.number)return s.value="Номер этапа обязателен";if(!a.name||!a.name.trim())return s.value="Название этапа обязательно";if(!a.internId)return s.value="Необходимо выбрать стажёра";try{(await T.put(`/stages/${d}`,{number:a.number,name:a.name,internId:a.internId,teamleadId:a.teamleadId})).status===200&&(l.value="Этап успешно обновлен!",z.emit("reloadStages"))}catch(k){s.value=((v=k.response)==null?void 0:v.data.message)??"Ошибка при обновлении этапа",console.error(k)}}function r(){s.value=null,l.value=null,h.push("/control")}return(_,d)=>(i(),f("div",{onClick:q(r,["stop"]),class:"addStagePage"},[e("form",{onSubmit:q(g,["prevent"]),onClick:d[4]||(d[4]=q(()=>{},["stop"])),class:"dark-blue-container"},[d[11]||(d[11]=e("h2",null,"Редактирование этапа",-1)),e("label",Xo,[d[5]||(d[5]=C(" Номер этапа ")),R(e("input",{"onUpdate:modelValue":d[0]||(d[0]=v=>a.number=v),type:"number",min:"1",required:""},null,512),[[D,a.number,void 0,{number:!0}]])]),e("label",Qo,[d[6]||(d[6]=C(" Название этапа ")),R(e("input",{"onUpdate:modelValue":d[1]||(d[1]=v=>a.name=v),type:"text",required:""},null,512),[[D,a.name]])]),e("label",Zo,[d[8]||(d[8]=C(" Стажёр ")),e("div",el,[R(e("select",{"onUpdate:modelValue":d[2]||(d[2]=v=>a.internId=v),required:""},[d[7]||(d[7]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(p.value,v=>(i(),f("option",{value:v.id,key:v.id},$(v.name)+" ("+$(v.login)+") ",9,tl))),128))],512),[[ee,a.internId]])])]),e("label",sl,[d[10]||(d[10]=C(" Тимлид ")),e("div",nl,[R(e("select",{"onUpdate:modelValue":d[3]||(d[3]=v=>a.teamleadId=v)},[d[9]||(d[9]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(u.value,v=>(i(),f("option",{value:v.id,key:v.id},$(v.name)+" ("+$(v.login)+") ",9,al))),128))],512),[[ee,a.teamleadId]])])]),d[12]||(d[12]=e("button",{type:"submit",class:"form-btn"},"Обновить этап",-1)),e("button",{type:"button",class:"red-btn",onClick:o},"Удалить"),s.value?(i(),f("span",ol,$(s.value),1)):U("",!0),l.value?(i(),f("span",ll,$(l.value),1)):U("",!0)],32)]))}}),il=N(rl,[["__scopeId","data-v-b52a75ae"]]),ul={for:""},dl=["value"],cl={for:""},pl={for:""},ml={for:""},vl={for:""},fl={class:"custom-select"},gl={for:""},hl={class:"custom-select"},_l=["value"],yl={key:0,class:"error"},bl={key:1,class:"success"},$l=O({__name:"updateTaskPage",setup(x){const m=X(),h=ae(),s=b(null),l=b(null),p=b(null),u=b({}),n=h.params.stageId,c=h.params.id,t=Q({number:null,name:null,desc:null,deadline:null,stageId:n||null,status:null}),y=Q({...t});async function a(){try{const k=await T.get("/stages");p.value=k.data.stages,console.log("Stages loaded:",k.data.stages),t.stageId&&p.value&&(p.value.find(E=>E.id===t.stageId)||await o(t.stageId))}catch(k){console.error("Error loading stages:",k)}}async function o(k){try{const w=await T.get(`/stages/${k}/tasks`);u.value[k]=w.data.tasks.length,console.log(`Tasks count for ${k}:`,u.value[k])}catch(w){console.error(`Error loading tasks for ${k}:`,w),u.value[k]=0}}async function g(){var k;try{if(!t.stageId||!c){console.error("Cannot fetch task: stageId or taskId is missing",{stageId:t.stageId,taskId:c});return}console.log(`Fetching task with stageId: ${t.stageId}, taskId: ${c}`);const E=(await T.get(`/stages/${t.stageId}/tasks/${c}`)).data.task;console.log("Task data received:",E),t.number=E.number,t.name=E.name||null,t.desc=E.desc||null,t.deadline=E.deadline?new Date(E.deadline).toISOString().split("T")[0]:null,t.stageId=E.stageId,t.status=E.status||"NOT_STARTED",Object.assign(y,{...t})}catch(w){console.error("Error loading task:",w),s.value=((k=w.response)==null?void 0:k.data.message)||"Не удалось загрузить задачу. Проверьте подключение или обратитесь к администратору.",console.log("Error response:",w.response)}}async function r(){var k;if(!t.stageId||!c){s.value="Не удалось определить этап или задачу для удаления.";return}if(confirm("Вы уверены, что хотите удалить эту задачу? Это действие нельзя отменить."))try{const w=await T.delete(`/stages/${t.stageId}/tasks/${c}`);console.log("Task deleted:",w.data),w.status===200&&(l.value="Задача успешно удалена!",z.emit("reloadStages"),m.push("/control"))}catch(w){s.value=((k=w.response)==null?void 0:k.data.message)??"Ошибка при удалении задачи",console.error("Error deleting task:",w)}}J(async()=>{console.log("Route params:",h.params),await a(),t.stageId&&c?(console.log("Mounting with stageId:",t.stageId,"taskId:",c),await o(t.stageId),await g()):console.log("Missing stageId or taskId:",{stageId:t.stageId,taskId:c})});const _=F(()=>{if(!t.stageId)return null;const k=u.value[t.stageId]||0;return console.log(`Computed taskNumber for ${t.stageId}:`,k+1),k+1});ve(()=>t.stageId,async k=>{console.log("StageId changed to",k),k?(await o(k),t.number=_.value,console.log("Updated taskForm.number:",t.number)):(t.number=null,console.log("Cleared taskForm.number"))});function d(){s.value=null,l.value=null,Object.assign(t,{...y}),m.push("/control")}async function v(k){var se,$e,oe;k.preventDefault(),s.value=null,l.value=null;const w=t.number||1,E=((se=t.name)==null?void 0:se.trim())||null,te=(($e=t.desc)==null?void 0:$e.trim())||null,re=t.deadline||null,ie=t.stageId||null,ue=t.status||"NOT_STARTED";if(!E)return s.value="Название задачи обязательно";if(!ie)return s.value="Необходимо выбрать этап";if(!re)return s.value="Дедлайн обязателен";try{(await T.put(`/stages/${ie}/tasks/${c}`,{number:w,name:E,desc:te,deadline:re,status:ue})).status===200&&z.emit("reloadStages")}catch(ge){s.value=((oe=ge.response)==null?void 0:oe.data.message)??"Ошибка при обновлении задачи",console.error("Error updating task:",ge)}}return(k,w)=>(i(),f("div",{onClick:q(d,["stop"]),class:"addTaskPage"},[e("form",{onSubmit:q(v,["prevent"]),onClick:w[5]||(w[5]=q(()=>{},["stop"])),class:"dark-blue-container"},[w[14]||(w[14]=e("h2",null,"Редактирование задачи",-1)),e("label",ul,[w[6]||(w[6]=C(" Номер задачи ")),e("input",{value:t.number,type:"number",readonly:"",required:""},null,8,dl)]),e("label",cl,[w[7]||(w[7]=C(" Название задачи ")),R(e("input",{"onUpdate:modelValue":w[0]||(w[0]=E=>t.name=E),type:"text",required:""},null,512),[[D,t.name]])]),e("label",pl,[w[8]||(w[8]=C(" Описание ")),R(e("input",{"onUpdate:modelValue":w[1]||(w[1]=E=>t.desc=E),type:"text"},null,512),[[D,t.desc]])]),e("label",ml,[w[9]||(w[9]=C(" Дедлайн ")),R(e("input",{"onUpdate:modelValue":w[2]||(w[2]=E=>t.deadline=E),type:"date",required:""},null,512),[[D,t.deadline]])]),e("label",vl,[w[11]||(w[11]=C(" Статус ")),e("div",fl,[R(e("select",{"onUpdate:modelValue":w[3]||(w[3]=E=>t.status=E),required:""},w[10]||(w[10]=[e("option",{value:"NOT_STARTED"},"Не начат",-1),e("option",{value:"HAS_STARTED"},"В процессе",-1),e("option",{value:"DONE"},"Завершен",-1),e("option",{value:"EXPIRED"},"Просрочен",-1)]),512),[[ee,t.status]])])]),e("label",gl,[w[13]||(w[13]=C(" Этап ")),e("div",hl,[R(e("select",{"onUpdate:modelValue":w[4]||(w[4]=E=>t.stageId=E),required:""},[w[12]||(w[12]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(p.value,E=>(i(),f("option",{value:E.id,key:E.id},$(E.name)+" (№"+$(E.number)+") ",9,_l))),128))],512),[[ee,t.stageId]])])]),w[15]||(w[15]=e("button",{type:"submit",class:"form-btn"},"Обновить задачу",-1)),e("button",{type:"button",class:"red-btn",onClick:r},"Удалить задачу"),s.value?(i(),f("span",yl,$(s.value),1)):U("",!0),l.value?(i(),f("span",bl,$(l.value),1)):U("",!0)],32)]))}}),kl=N($l,[["__scopeId","data-v-117c230e"]]),wl={},Il={class:"accessDeniedPage"};function xl(x,m){return i(),f("div",Il,[m[1]||(m[1]=e("h1",null,"Доступ запрещен!",-1)),m[2]||(m[2]=e("p",null,"У вас нет прав для просмотра этой страницы.",-1)),e("button",{onClick:m[0]||(m[0]=h=>x.$router.push("/"))},"Вернуться")])}const Cl=N(wl,[["render",xl],["__scopeId","data-v-cc9f686d"]]),Tl={class:"custom-select"},Sl=["value"],Pl={class:"custom-select"},Rl=["value"],Ul={key:0,class:"error"},Hl=O({__name:"updateInternPage",setup(x){const m=ae(),h=X(),s=b(null),l=m.params.id,p=b(null),u=b(null);async function n(){try{const g=await T.get("/positions");p.value=g.data.positions}catch(g){console.error(g)}}async function c(){try{const g=await T.get("/users/teamleads");u.value=g.data.teamleads}catch(g){console.error(g)}}const t=Q({login:null,name:null,email:null,password:null,positionId:null,mentorId:null});J(async()=>{var g,r;await n(),await c();try{const d=(await T.get(`/users/interns/${l}`)).data.intern;t.login=d.login,t.name=d.name,t.email=d.email,t.positionId=((g=d.position)==null?void 0:g.id)||null,t.mentorId=((r=d.mentor)==null?void 0:r.id)||null}catch(_){console.error(_),s.value="Не удалось загрузить стажера"}});function y(){s.value=null,h.push("/interns")}async function a(g){var _;if(g.preventDefault(),s.value=null,!t.login||!t.login.trim())return s.value="Логин обязателен";if(!t.name||!t.name.trim())return s.value="Имя обязательно";if(!t.email||!t.email.trim())return s.value="Почта обязательна";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email))return s.value="Некорректный email";try{(await T.put(`/users/interns/${l}`,t)).status===200&&(z.emit("reloadInterns"),h.push("/interns"))}catch(d){s.value=((_=d.response)==null?void 0:_.data.message)??"Ошибка при обновлении стажера",console.error(d)}}async function o(){var r;if(confirm("Вы уверены, что хотите удалить этого стажера?"))try{(await T.delete(`/users/interns/${l}`)).status===200&&(z.emit("reloadInterns"),h.push("/interns"))}catch(_){s.value=((r=_.response)==null?void 0:r.data.message)??"Ошибка при удалении стажера",console.error(_)}}return(g,r)=>(i(),f("div",{onClick:q(y,["stop"]),class:"updateInternPage"},[e("form",{onSubmit:a,onClick:r[6]||(r[6]=q(()=>{},["stop"])),class:"dark-blue-container"},[r[15]||(r[15]=e("h2",null,"Изменение стажера",-1)),e("label",null,[r[7]||(r[7]=C(" Логин ")),R(e("input",{"onUpdate:modelValue":r[0]||(r[0]=_=>t.login=_),type:"text",required:""},null,512),[[D,t.login]])]),e("label",null,[r[8]||(r[8]=C(" Имя ")),R(e("input",{"onUpdate:modelValue":r[1]||(r[1]=_=>t.name=_),type:"text",required:""},null,512),[[D,t.name]])]),e("label",null,[r[9]||(r[9]=C(" Почта ")),R(e("input",{"onUpdate:modelValue":r[2]||(r[2]=_=>t.email=_),type:"email",required:""},null,512),[[D,t.email]])]),e("label",null,[r[10]||(r[10]=C(" Пароль ")),R(e("input",{"onUpdate:modelValue":r[3]||(r[3]=_=>t.password=_),type:"password",placeholder:"Оставьте пустым, если не меняете"},null,512),[[D,t.password]])]),e("label",null,[r[12]||(r[12]=C(" Должность ")),e("div",Tl,[R(e("select",{"onUpdate:modelValue":r[4]||(r[4]=_=>t.positionId=_),required:""},[r[11]||(r[11]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(p.value,_=>(i(),f("option",{value:_.id,key:_.id},$(_.name),9,Sl))),128))],512),[[ee,t.positionId]])])]),e("label",null,[r[14]||(r[14]=C(" Ментор ")),e("div",Pl,[R(e("select",{"onUpdate:modelValue":r[5]||(r[5]=_=>t.mentorId=_)},[r[13]||(r[13]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(u.value,_=>(i(),f("option",{value:_.id,key:_.id},$(_.name),9,Rl))),128))],512),[[ee,t.mentorId]])])]),r[16]||(r[16]=e("button",{type:"submit",class:"form-btn"},"Обновить стажера",-1)),e("button",{type:"button",onClick:o,class:"red-btn"},"Удалить"),s.value?(i(),f("span",Ul,$(s.value),1)):U("",!0)],32)]))}}),El=N(Hl,[["__scopeId","data-v-d3e45936"]]),Ml={class:"custom-select"},Dl=["value"],Al={key:0,class:"error"},ql=O({__name:"addTeamleadPage",setup(x){const m=X(),h=b(null),s=b(null);async function l(){try{const c=await T.get("/positions");s.value=c.data.positions}catch(c){console.error(c)}}J(async()=>await l());const p=Q({login:null,name:null,email:null,password:null,positionId:null});function u(){h.value=null,m.push("/teamleads")}async function n(c){var y;if(c.preventDefault(),h.value=null,!p.login||!p.login.trim())return h.value="Логин обязателен";if(!p.name||!p.name.trim())return h.value="Имя обязательно";if(!p.email||!p.email.trim())return h.value="Почта обязательна";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p.email))return h.value="Некорректный email";if(!p.password||p.password.length<6)return h.value="Пароль должен быть не менее 6 символов";try{const a=await T.post("/users/teamleads",p);(a.status===201||a.status===200)&&(z.emit("reloadTeamleads"),m.push("/teamleads"))}catch(a){h.value=((y=a.response)==null?void 0:y.data.message)??"Ошибка при регистрации тимлида",console.error(a)}}return(c,t)=>(i(),f("div",{onClick:q(u,["stop"]),class:"addTeamleadPage"},[e("form",{onSubmit:n,onClick:t[5]||(t[5]=q(()=>{},["stop"])),class:"dark-blue-container"},[t[12]||(t[12]=e("h2",null,"Добавление тимлида",-1)),e("label",null,[t[6]||(t[6]=C(" Логин ")),R(e("input",{"onUpdate:modelValue":t[0]||(t[0]=y=>p.login=y),type:"text",required:""},null,512),[[D,p.login]])]),e("label",null,[t[7]||(t[7]=C(" Имя ")),R(e("input",{"onUpdate:modelValue":t[1]||(t[1]=y=>p.name=y),type:"text",required:""},null,512),[[D,p.name]])]),e("label",null,[t[8]||(t[8]=C(" Почта ")),R(e("input",{"onUpdate:modelValue":t[2]||(t[2]=y=>p.email=y),type:"email",required:""},null,512),[[D,p.email]])]),e("label",null,[t[9]||(t[9]=C(" Пароль ")),R(e("input",{"onUpdate:modelValue":t[3]||(t[3]=y=>p.password=y),type:"password",required:""},null,512),[[D,p.password]])]),e("label",null,[t[11]||(t[11]=C(" Должность ")),e("div",Ml,[R(e("select",{"onUpdate:modelValue":t[4]||(t[4]=y=>p.positionId=y),required:""},[t[10]||(t[10]=e("option",{value:null},"Не выбрано",-1)),(i(!0),f(L,null,B(s.value,y=>(i(),f("option",{key:y.id,value:y.id},$(y.name),9,Dl))),128))],512),[[ee,p.positionId]])])]),t[13]||(t[13]=e("button",{type:"submit",class:"form-btn"},"Зарегистрировать тимлида",-1)),h.value?(i(),f("span",Al,$(h.value),1)):U("",!0)],32)]))}}),Vl=N(ql,[["__scopeId","data-v-fa56c16d"]]),Ll={class:"custom-select"},Nl=["value"],Fl={key:0,class:"error"},Ol=O({__name:"updateTeamleadPage",setup(x){const m=ae(),h=X(),s=b(null),l=m.params.id,p=b(null);async function u(){try{const a=await T.get("/positions");p.value=a.data.positions}catch(a){console.error(a)}}const n=Q({login:null,name:null,email:null,password:null,positionId:null});J(async()=>{var a;await u();try{const g=(await T.get(`/users/teamleads/${l}`)).data.teamlead;n.login=g.login,n.name=g.name,n.email=g.email,n.positionId=((a=g.position)==null?void 0:a.id)||null,console.log("Loaded teamlead:",n)}catch(o){console.error(o),s.value="Не удалось загрузить тимлида"}});function c(){s.value=null,h.push("/teamleads")}async function t(a){var g;if(a.preventDefault(),s.value=null,!n.login||!n.login.trim())return s.value="Логин обязателен";if(!n.name||!n.name.trim())return s.value="Имя обязательно";if(!n.email||!n.email.trim())return s.value="Почта обязательна";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email))return s.value="Некорректный email";try{const r=await T.put(`/users/teamleads/${l}`,n);console.log(r.data),r.status===200&&(z.emit("reloadTeamleads"),h.push("/teamleads"))}catch(r){s.value=((g=r.response)==null?void 0:g.data.message)??"Ошибка при обновлении тимлида",console.error(r)}}async function y(){var o;if(confirm("Вы уверены, что хотите удалить этого тимлида?"))try{(await T.delete(`/users/teamleads/${l}`)).status===200&&h.push("/teamleads")}catch(g){s.value=((o=g.response)==null?void 0:o.data.message)??"Ошибка при удалении тимлида",console.error(g)}}return(a,o)=>(i(),f("div",{onClick:q(c,["stop"]),class:"updateTeamleadPage"},[e("form",{onSubmit:t,onClick:o[5]||(o[5]=q(()=>{},["stop"])),class:"dark-blue-container"},[o[12]||(o[12]=e("h2",null,"Изменение тимлида",-1)),e("label",null,[o[6]||(o[6]=C(" Логин ")),R(e("input",{"onUpdate:modelValue":o[0]||(o[0]=g=>n.login=g),type:"text",required:""},null,512),[[D,n.login]])]),e("label",null,[o[7]||(o[7]=C(" Имя ")),R(e("input",{"onUpdate:modelValue":o[1]||(o[1]=g=>n.name=g),type:"text",required:""},null,512),[[D,n.name]])]),e("label",null,[o[8]||(o[8]=C(" Почта ")),R(e("input",{"onUpdate:modelValue":o[2]||(o[2]=g=>n.email=g),type:"email",required:""},null,512),[[D,n.email]])]),e("label",null,[o[9]||(o[9]=C(" Пароль ")),R(e("input",{"onUpdate:modelValue":o[3]||(o[3]=g=>n.password=g),type:"password",placeholder:"Оставьте пустым, если не меняете"},null,512),[[D,n.password]])]),e("label",null,[o[11]||(o[11]=C(" Должность ")),e("div",Ll,[R(e("select",{"onUpdate:modelValue":o[4]||(o[4]=g=>n.positionId=g),required:""},[o[10]||(o[10]=e("option",{value:null,selected:""},"Не выбрано",-1)),(i(!0),f(L,null,B(p.value,g=>(i(),f("option",{value:g.id,key:g.id},$(g.name),9,Nl))),128))],512),[[ee,n.positionId]])])]),o[13]||(o[13]=e("button",{type:"submit",class:"form-btn"},"Обновить тимлида",-1)),e("button",{type:"button",onClick:y,class:"red-btn"},"Удалить"),s.value?(i(),f("span",Fl,$(s.value),1)):U("",!0)],32)]))}}),Bl=N(Ol,[["__scopeId","data-v-f1d3b520"]]),zl=[{path:"/login",component:Ls,meta:{requiresGuest:!0}},{path:"/register",component:fa,meta:{requiresGuest:!0}},{path:"/",component:Et,meta:{requiresRole:["HR","TEAMLEAD","INTERN"]}},{path:"/chats",component:Zt,meta:{requiresRole:["HR","TEAMLEAD","INTERN"]}},{path:"/chats/:chatId",component:da,props:!0},{path:"/interns",component:Te,meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/interns/:id",component:Hs,meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/interns/add",components:{default:Te,modal:Sa},meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/interns/update/:id",components:{default:Te,modal:El},meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/teamleads",component:Pe,meta:{requiresRole:["HR"]}},{path:"/teamleads/add",components:{default:Pe,modal:Vl},meta:{requiresRole:["HR"]}},{path:"/teamleads/update/:id",components:{default:Pe,modal:Bl},meta:{requiresRole:["HR"]}},{path:"/control",component:_e,meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/control/stages/add",components:{default:_e,modal:Vo},meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/control/stages/:stageId/update",components:{default:_e,modal:il},meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/control/stages/:stageId/tasks/add",components:{default:_e,modal:Yo},meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/control/stages/:stageId/tasks/:id/update",components:{default:_e,modal:kl},meta:{requiresRole:["HR","TEAMLEAD"]}},{path:"/stages",component:Ks},{path:"/stages/:stageId/tasks/:id",component:pn,meta:{requiresRole:["INTERN"]}},{path:"/positions",component:Se,meta:{requiresRole:["HR"]}},{path:"/positions/add",components:{default:Se,modal:qa},meta:{requiresRole:["HR"]}},{path:"/positions/update/:id",components:{default:Se,modal:Fa},meta:{requiresRole:["HR"]}},{path:"/access-denied",component:Cl}],Ie=Ke({history:Ye(),routes:zl});Ie.beforeEach((x,m,h)=>{const s=ce(),l=s.isAuthenticated,p=s.userRole;x.meta.requiresGuest&&l?h("/"):!x.meta.requiresGuest&&!l?h("/login"):x.meta.requiresRole&&!x.meta.requiresRole.includes(p)?h("/access-denied"):h()});const fe=Xe(St);fe.use(Ie);fe.use(st());fe.use(Qe);fe.component("apexchart",le);fe.use(Ze);fe.mount("#app");
